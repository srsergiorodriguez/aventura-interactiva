import{S as Te,i as Ce,s as Ne,e as T,a as A,t as F,w as _e,b as C,d as M,j as L,f as H,g as _,A as p,l as U,k as v,K as P,n as Oe,L as ze,v as oe,r as Fe,M as ve,D as ue,c as Kt,N as He,u as Ft,m as Ht,o as Jt,p as $,q as te,O as we,P as ye,F as fe,G as de,H as he,I as pe,Q as ke,R as Ie,T as Se,U as Ze,V as ft,C as We,x as Ke,W as je,X as Je,z as Xt,Y as Re,Z as Pe,_ as dt}from"../chunks/index.4d86df2e.js";import{w as nt,r as Ge}from"../chunks/index.9d73ec15.js";const qe=nt(!0),Ye=nt(void 0),ot=nt({typewriterSpeed:20,adventureSlide:!1,adventureScroll:!1,evalTags:!1,backBtn:!1,restartBtn:!1,prevScene:void 0,topScene:void 0,defaultCSS:!0,sceneCallback:function(s){this.prevScene===void 0&&(this.prevScene=s.key),this.backBtn&&this.prevScene!==void 0&&this.prevScene!==s.key&&this.topScene!==s.key&&(s.opciones!==void 0?s.opciones.filter(e=>e.btn==="Regresar").length<1&&s.opciones.push({btn:"Regresar",escena:this.prevScene}):(s.opciones=[],s.opciones.push({btn:"Regresar",escena:this.prevScene})),this.prevScene=s.key),this.topScene===void 0&&(this.topScene=s.key),this.restartBtn&&this.topScene!==void 0&&this.topScene!==s.key&&(s.opciones!==void 0?s.opciones.filter(e=>e.btn==="Reiniciar").length<1&&s.opciones.push({btn:"Reiniciar",escena:this.topScene}):(s.opciones=[],s.opciones.push({btn:"Reiniciar",escena:this.topScene})))}}),le=nt({inicio:{texto:"Érase una vez un círculo...",display:{x:150,y:90},opciones:[{btn:"dejar tranquilo",escena:"final1"},{btn:"aplastar",escena:"final2"}]},final1:{texto:"Perfecto, un final redondo",sinSalida:!0,display:{x:50,y:300}},final2:{texto:"Parece que la historia formó una elipsis",sinSalida:!0,display:{x:230,y:300}}}),it=Ge(s=>s.scene===void 0&&s.escena!==void 0?"escena":"scene"),st=Ge(s=>s.options===void 0&&s.opciones!==void 0?"opciones":"options"),xt=Ge(s=>s.text===void 0&&s.texto!==void 0?"texto":"text"),Yt=Ge(s=>s.image===void 0&&s.imagen!==void 0?"imagen":"image");function Zt(s,e,t){const n=document.createElement("a");n.href=URL.createObjectURL(new Blob([s],{type:e})),n.setAttribute("download",t),document.body.appendChild(n),n.click(),document.body.removeChild(n)}const $t=Ge((s,e)=>{Zt(JSON.stringify(s,null,2),"application/json",`${e.includes(".json")?e:e+".json"}`)}),en=Ge(s=>{Zt(s,"text/plain;charset=utf-8","index.html")}),tn=function(s,e,t,n){return`
<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="utf-8">
  </head>
  <body>
  </body>
  <script>
    const lang = "es";
    const options = ${n}
    options.defaultCSS = false;
    options.sceneCallback =  function(e) {
      if (this.prevScene === undefined) { this.prevScene = e.key }
      if (this.backBtn && this.prevScene !== undefined && this.prevScene !== e.key && this.topScene !== e.key) {
        if (e.opciones !== undefined) {
          if (e.opciones.filter(d => d.btn === "Regresar").length < 1) {
            e.opciones.push({btn: "Regresar", escena: this.prevScene})
          }
        } else {
          e.opciones = [];
          e.opciones.push({btn: "Regresar", escena: this.prevScene})
        }
        this.prevScene = e.key;
      }

      if (this.topScene === undefined) { this.topScene = e.key }
      if (this.restartBtn && this.topScene !== undefined && this.topScene !== e.key) {
        if (e.opciones !== undefined) {
          if (e.opciones.filter(d => d.btn === "Reiniciar").length < 1) {
            e.opciones.push({btn: "Reiniciar", escena: this.topScene})
          }
        } else {
          e.opciones = [];
          e.opciones.push({btn: "Reiniciar", escena: this.topScene})
        }
      }
    }
  <\/script>
  <style>
    
  #storygeneraldiv {
    box-sizing: border-box;
    margin: auto;
    max-width: 600px;
    font-family: 'Courier New', Courier, monospace;
    background: white;
  }
  
  .storydiv {
    border: solid black 1px;
    width: 100%;
    display: flex;
    padding: 10px;
    flex-direction: column;
    box-sizing: border-box;
  }
  
  .storyp {
    font-size: 18px;
    min-height: 25px;
  }
  
  .storybutton-container {
    margin: auto;
  }
  
  .storybutton {
    background: white;
    box-shadow: none;
    border: solid 1px;
    margin: 0px 1em 0px 0px;
    font-size: 20px;
    font-family: 'Courier New', Courier, monospace;
    cursor: pointer;
  }
  
  .storybutton:hover {
    color: white;
    background: black;
  }
  
  .storyimage-container {
    box-sizing: content-box;
    position: relative;
    width: 100%;
    margin: auto;
  }
  
  .storyimage {
    justify-content: center;
    width: 100%;
    margin: auto;
    border-radius: 20px;
    display: block;
  }
  
  .storyimage-area {
    font-size: 14px;
    position: absolute;
    cursor: pointer;
    text-align: center;
    color: black;
    background: #ffffff00;
    border: solid 1px black;
  }
  
  .storyimage-area:hover {
    background: #ffffff33;
  }
  
  @media screen and (max-device-width: 500px) {
    #storygeneraldiv {
      max-width:100%;
    }
    .storyp {
      font-size: 7vw;
    }
    .storybutton {
      font-size: 10vw;
    }
  }
  
  </style>
  <script>
    const A = ${s}
  <\/script>
  <script>
    const scenes = ${e};
    const aventura = new A(lang, options);
    aventura.setScenes(scenes).startAdventure('${t}');
  <\/script>
</html>
`},nn=Ge(tn);class sn{constructor(e="en",t){this.lang=e==="en"||e==="es"?e:"en",this.options={typewriterSpeed:50,defaultCSS:!0,adventureContainer:void 0,adventureScroll:!1,adventureSlide:!0,evalTags:!1,igramaFormat:"png",urlWord:"URL",vizWidth:1e3,vizHeight:1e3,vizBg:"#313131",vizCol:"black",vizImageSize:50,vizLoading:!0,minigifOptions:{},sceneCallback:n=>n},t&&(this.options=Object.assign(this.options,this.setOptionsTranslations(t))),this.grammarError=!1,this.scenesError=!1,this.fijarGramatica=this.setGrammar,this.expandirGramatica=this.expandGrammar,this.probarGramatica=this.testGrammar,this.fijarEscenas=this.setScenes,this.fijarDatosEscenas=this.setDataScenes,this.iniciarAventura=this.startAdventure,this.probarEscenas=this.testScenes,this.cargarJSON=this.loadJSON,this.modeloMarkov=this.getMarkovModel,this.fijarMarkov=this.setMarkov,this.cadenaMarkov=this.markovChain,this.probarDistribucion=this.testDistribution,this.markovSeparator=/[^\S\r\n]+/i,this.fijarIgrama=this.setIgrama,this.expandirIgrama=this.expandIgrama,this.mostrarIgrama=this.showIgrama,this.textoIgrama=this.getIgramaText,this.imgsMemo={},this.storyPreload={}}setOptionsTranslations(e){const t={velocidadMaquina:"typewriterSpeed",CSSporDefecto:"defaultCSS",contenedorAventura:"adventureContainer",rolloAventura:"adventureScroll",deslizarAImagen:"adventureSlide",ejecutarEtiquetas:"evalTags",formatoIgrama:"igramaFormat",palabraUrl:"urlWord",anchoVis:"vizWidth",altoVis:"vizHeight",fondoVis:"vizBg",colorVis:"vizCol",tamanoImagenVis:"visImageSize",cargandoVis:"vizLoading",opcionesMinigif:"minigifOptions",funcionEscena:"sceneCallback"};for(let[n,o]of Object.entries(e))t[n]!==void 0&&(e[t[n]]=o,delete e[n]);return e}setGrammar(e){return this.grammar=e,this}setIgrama(e){this.igrama=e;for(let[t,n]of Object.entries(e.grammar));return this}setScenes(e){this.options.defaultCSS&&this.setCSS(),this.scenes=e;for(let t of Object.keys(e)){this.scenes[t].key=t;const n=this.scenes[t].image||this.scenes[t].imagen;n!==void 0&&this.storyPreload[n]===void 0&&(this.storyPreload[n]=new Image,this.storyPreload[n].src=n,this.storyPreload[n].className="storyimage")}return this}async setDataScenes(e,t=void 0,n=[]){if(this.options.defaultCSS&&this.setCSS(),typeof d3>"u"){console.error(this.lang==="es"?"Para crear visualizaciones debes tener también la librería D3":"To create visualizations you must have also the D3 library");return}return this.scenes=JSON.parse(JSON.stringify(e)),this.metaKeys=n,t!==void 0&&(this.data=JSON.parse(JSON.stringify(t)),await this.setViz(this.scenes,this.data)),this.setScenes(this.scenes),this}async setViz(e,t){const n=Object.keys(e),o={compare:on,scatter:rn,pack:ln};let i=0;for(let u of n)e[u].viz!==void 0&&i++;let r=0,l;const a=this.lang==="en"?"Loading...":"Cargando...";this.options.vizLoading&&(l=document.createElement("div"),l.id="storygeneraldiv",l.className="storydiv",l.textContent=a,(this.options.adventureContainer!==void 0?document.getElementById(this.options.adventureContainer):document.body).appendChild(l));function f(u,c=15){let d="";for(let h=0;h<Math.ceil(c);h++)d+=h<u*c?"|":"-";return d}for(let u of n){if(e[u].viz===void 0)continue;const{filter:c,type:d,x:h,y:S}=e[u].viz;if(o[d]===void 0||h===void 0||S===void 0){const b=this.lang==="es"?`Parámetros incorrectos de visualización en la escena "${u}"`:`Incorrect parameteres in the scene "${u}"`;console.error(b)}let w=t;for(let b of c)w=this.filterFn(b)(w);let E=r;const{viz:y,areas:m}=await o[d](this,w,h,S,b=>{r=E+b/i;const g=Math.ceil(r*100);this.options.vizLoading&&(l.textContent=`${a} ${f(r)} ${g}%`)});e[u].image=y,e[u].areas=m}for(let u of t){if(u.ID===void 0){const c=this.lang==="es"?"Todos los datos deben tener un valor único con la clave ID":"All data must have a unique value with the ID key";console.error(c),this.scenes={};break}e[`ind_${u.ID}`]={text:`${u.CONT||""}`,meta:u.ID,dataScene:!0,options:[{btn:"<<<",scene:`ind_${u.ID}`}]},u.IMGURL!==void 0&&(e[`ind_${u.ID}`].image=u.IMGURL),u.URL!==void 0&&(e[`ind_${u.ID}`].url=u.URL)}l.remove()}filterFn(e){const t=e[1];if(t==="="||t==="=="||t==="===")return o=>o.filter(i=>n(i[e[0]])==n(e[2]));return t==="<"?o=>o.filter(i=>n(i[e[0]])<n(e[2])):t===">"?o=>o.filter(i=>n(i[e[0]])>n(e[2])):o=>o;function n(o){return o==="true"?!0:o==="false"?!1:o}}setMarkov(e){return this.markov=e,this}expandGrammar(e){const t=this.selectGrammarRule(this.grammar[e]);return this.grammarRuleRecursion(t)}expandIgrama(e){const t=this.igrama.grammar,n=this.selectGrammarRule(t[e]);return this.grammarRuleRecursion(n,t).split("|").map(i=>this.decodeDrawing(i))}grammarRuleRecursion(e,t){let n=t||this.grammar,o=this.setNewRules(e);const i=o.match(/<[\w\d.,/#]+>/gi);if(!i)return o;for(let r of i){const l=this.defineTransformations(r);o=o.replace(r,()=>{r=r.replace(/[<>]/gi,""),r=r.replace(/#[\w\d.,/]+#/g,"");const a=r.search(/[.]/)>-1?this.getNestedObject(n,r.match(/[\w\d]+/g)):n[r];if(!a){const u=this.lang==="es"?`Se intentó expandir desde la regla "${r}", pero no se pudo encontrar`:`Tried to expand from rule "${r}", but couldn't find it`;console.error(u)}const f=this.selectGrammarRule(a);return this.transformString(f,l)})}return this.grammarRuleRecursion(o,n)}setNewRules(e,t){let n;t===void 0?n=this.grammar:n=t;let o=e;const i=o.match(/\$[\w\d]+\$\[[\w\d:,-]+\]/ig);if(i)for(;i.length;){const r=i.pop();o=o.replace(r,"");const{symbol:l,pairsString:a}=/\$(?<symbol>[\w\d]+)\$\[(?<pairsString>[\w\d:,-]+)\]/i.exec(r).groups,f=a.match(/[-]?[\w\d]+:[\w\d]+/gi).map(u=>/(?<remove>[-]?)(?<key>[\w\d]+)[ ]?:[ ]?(?<value>[\w\d]+)/gi.exec(u).groups);if(f){n[l]=n[l]||{};for(let u of f){const c=n[u.value];if(!c){const S=this.lang==="es"?`Se intentó crear la nueva regla "${l}", pero no se pudo encontrar "${u.value}" para producir la subregla "${u.key}"`:`Tried to create new rule: "${l}", but couldn't find "${u.value}" to produce "${u.key}" subrule`;console.error(S)}const d=u.remove==="-",h=this.selectGrammarRule(c);if(d){const S=c.indexOf(h);n[u.value]=[...c.slice(0,S),...c.slice(S+1)]}n[l][u.key]=[h]}}}return o}startAdventure(e){const t=document.createElement("div");return t.id="storygeneraldiv",(this.options.adventureContainer!==void 0?document.getElementById(this.options.adventureContainer):document.body).appendChild(t),this.prevScene=e,this.goToScene(this.scenes[e]),this}goToScene(e){const t=document.getElementById("storygeneraldiv");(!this.options.adventureScroll||e.plop===!0)&&[...document.getElementsByClassName("storydiv")].map(a=>a.remove()),[...document.getElementsByClassName("storyimage-area")].map(l=>l.remove());const o=document.createElement("div");if(o.className="storydiv",t.appendChild(o),e.image||e.imagen){const l=document.createElement("div");l.className="storyimage-container",o.appendChild(l);const a=e.image||e.imagen,f=this.options.adventureScroll?this.storyPreload[a].cloneNode():this.storyPreload[a];l.appendChild(f),e.areas&&(f.complete?this.setAreas(f,l,e.areas):f.onload=()=>{this.setAreas(f,l,e.areas)})}else if(e.igrama!==void 0){const l=document.createElement("div");l.className="storyimage-container",o.appendChild(l);const a=this.expandIgrama(e.igrama);e.igramaText=this.getIgramaText(a),this.igramaDataUrl(a,this.options.igramaFormat).then(f=>{const u=new Image;u.src=f,u.className="storyimage",l.appendChild(u)})}if(e.title||e.titulo){const l=document.createElement("div");l.className="storytitle-container",o.appendChild(l);const a=document.createElement("h1");a.className="storytitle",a.textContent=e.title||e.titulo,l.appendChild(a)}if(e.meta!==void 0){const l=document.createElement("div");l.className="storymeta-container",o.appendChild(l);const a=this.data.find(f=>f.ID==e.meta);for(let f of this.metaKeys){if(a[f]===void 0)continue;const u=document.createElement("div");u.className="storymeta-subcontainer",l.appendChild(u);const c=document.createElement("span");c.className="storymeta-key",c.textContent=`${f}: `,u.appendChild(c);const d=document.createElement("span");d.className="storymeta-val",d.textContent=a[f],u.appendChild(d)}}const i=document.createElement("div");i.className="storyp-container",(e.text||e.texto||e.igramaText)&&o.appendChild(i);const r=document.createElement("p");if(r.className="storyp",r.textContent="",i.appendChild(r),e.url){const l=document.createElement("a");l.className="storyurl",l.href=e.url,l.target="_blank",l.textContent=this.options.urlWord,i.appendChild(l)}this.options.adventureSlide&&document.getElementById("storygeneraldiv").scrollIntoView({behavior:"smooth",block:"end"}),this.typewriter(r,e),this.data&&(e.viz!==void 0?this.prevScene=e.key:e.dataScene===!0&&(e.options[0].scene=this.prevScene)),this.options.sceneCallback(e)}setAreas(e,t,n){const o=e.getBoundingClientRect(),i=t.getBoundingClientRect();window.onresize=()=>{document.getElementsByClassName("storyimage-area").length>0&&this.setAreas(e,t,n)},[...document.getElementsByClassName("storyimage-area")].map(l=>l.remove());for(let l of n){let a=document.createElement("div");a.className="storyimage-area";const f=(l.x-Math.floor(l.w/2))*o.width/e.naturalWidth;a.style.left=`${o.left-i.left+f}px`;const u=(l.y-Math.floor(l.h/2))*o.height/e.naturalHeight;a.style.top=`${o.top-i.top+u}px`,a.style.width=`${l.w*o.width/e.naturalWidth}px`,a.style.height=`${l.h*o.height/e.naturalHeight}px`,a.textContent=l.btn||"",f>0&&f<o.width&&u>0&&u<o.height&&t.appendChild(a),a.style.fontSize=`${18*o.height/e.naturalHeight}px`,a.onclick=()=>{const c=l.scene||l.escena;this.goToScene(this.scenes[c])},l.tooltip!==void 0&&(a.onmouseover=()=>{a.textContent=l.tooltip||"",a.style.zIndex="100"},a.onmouseout=()=>{a.textContent=l.btn||"",a.style.zIndex="0"})}}async typewriter(e,t){const n=t.text||t.texto||t.igramaText||"";let o=this.grammar?this.grammarRuleRecursion(n):n;if(o=o.replace(/\n/g,"<br>"),this.options.typewriterSpeed>0){let i=0;await new Promise(r=>{const l=setInterval(()=>{const a=o.substring(0,i);this.options.evalTags?e.innerHTML=a:e.textContent=a,i++,i>o.length&&(clearInterval(l),r(!0))},Math.floor(this.options.typewriterSpeed))}),this.optionButtons(t)}else this.options.evalTags?e.innerHTML=o:e.textContent=o,this.optionButtons(t)}optionButtons(e){const t=[...document.getElementsByClassName("storydiv")],n=t[t.length-1];[...document.getElementsByClassName("storybutton-container")].map(r=>r.remove());const i=document.createElement("div");if(i.className="storybutton-container",n.appendChild(i),e.options||e.opciones){const r=e.options||e.opciones;for(let l of r){const a=document.createElement("button");a.className="storybutton",a.textContent=l.btn,i.appendChild(a),a.addEventListener("click",()=>{if((l.text||l.texto)===void 0){const u=l.scene||l.escena;this.goToScene(this.scenes[u])}else this.goToScene(l)})}}else if(e.scene||e.escena){const r=e.scene||e.escena,l=document.createElement("button");l.className="storybutton",l.textContent=this.lang==="en"?"Continue":"Continuar",i.appendChild(l),l.addEventListener("click",()=>{this.goToScene(this.scenes[r])})}this.options.adventureSlide&&document.getElementById("storygeneraldiv").scrollIntoView({behavior:"smooth",block:"end"})}selectGrammarRule(e){if(e.length===0)return"";if(e.prob){const o=Math.random()*e.prob.reduce((r,l)=>r+l);let i=0;for(let r=0;r<e.prob.length;r++){if(i<=o&&o<i+e.prob[r])return e[r];i+=e.prob[r]}}const t=Math.floor(Math.random()*e.length);return e[t]}getNestedObject(e,t){return t.reduce((n,o)=>n&&n[o]!==void 0?n[o]:void 0,e)}defineTransformations(e){let t={};const n=/#(?<trans>[\w\d,]+)#/gi.exec(e),o=n?n.groups.trans.match(/[\w]+/gi):[];for(let i of o)t[i]=!0;return t}transformString(e,t){let n=e;return t.CAPITALIZE&&(n=n.charAt(0).toUpperCase()+n.slice(1)),t.ALLCAPS&&(n=n.toUpperCase()),n}decodeDrawing(e){if(e==="")return[];const[t,n,o]=e.split("%%");let i={};return t==="vector"?i.content=n.split("**").map(r=>{const[l,a,f]=r.split("&"),u=[];if(u.color=l,u.weight=a,f===void 0)return u;const c=f.split(",");for(let d=0;d<c.length;d+=2)u.push([+c[d],+c[d+1]]);return u}):i.content=n,i.attribute=o,i.type=t,i}async getMarkovModel(e,t=1,n=!1){let o=await(await fetch(`./${e}`)).text();o=o.replace(/([,:.;])/g," $1").replace(/[()\¿¡!?”“—-]/g,"").toLowerCase();const i=o.split(this.markovSeparator),r={};for(let a=0;a<i.length-t;a++){let f="";for(let c=0;c<t;c++)f+=c===0?i[a+c]:" "+i[a+c];r[f]===void 0&&(r[f]={});const u=i[a+t];r[f][u]===void 0?r[f][u]=1:r[f][u]++}const l={};for(let a of Object.keys(r)){const f=Object.keys(r[a]);l[a]={probs:[],grams:f};let u=0;for(let c=0;c<f.length;c++)u+=r[a][f[c]];for(let c=0;c<f.length;c++)l[a].probs[c]=r[a][f[c]]/u}if(n){const a=e.split("/");this.saveJSON(l,`${a[a.length-1]}_markovModel_${t}N.json`)}return l}markovChain(e,t,n=.1){let o=t===void 0||this.markov[t]===void 0?this.randomMarkovWord():t,i=o;for(let l=0;l<e-1;l++){let a=this.getNextMarkov(this.markov[i]);a===void 0&&(a=this.getNextMarkov(this.randomMarkovWord()));let f=i.split(this.markovSeparator);f.push(a),f=f.slice(1).join(" "),i=f,o+=` ${a}`}return this.formatMarkov(o,n)}randomMarkovWord(){const e=Math.floor(Math.random()*Object.keys(this.markov).length);return Object.keys(this.markov)[e]}getNextMarkov(e){const t=Math.random();let n=0;if(e!==void 0)for(let o=0;o<e.probs.length;o++){if(n<=t&&t<n+e.probs[o])return e.grams[o];n+=e.probs[o]}}formatMarkov(e,t=.1){let n=e.replace(/ ([,:.;])/g,"$1");return n=n.replaceAll(/([.]) ([\wáéíóú])/ig,(o,i,r,l,a)=>Math.random()<t?`.
${r.toUpperCase()}`:`. ${r.toUpperCase()}`),n.charAt(0).toUpperCase()+n.slice(1)}async loadJSON(e){return await(await fetch(e)).json()}saveJSON(e,t){const n=document.createElement("a");n.href=URL.createObjectURL(new Blob([JSON.stringify(e,null,2)],{type:"application/json"})),n.setAttribute("download",`${t.includes(".json")?t:t+".json"}`),document.body.appendChild(n),n.click(),document.body.removeChild(n)}testScenes(e){const t=e||this.scenes;if(!t){const o=this.lang==="es"?"No hay escenas para probar":"There are not scenes to test";console.error(o)}let n=[];for(let o of Object.keys(t)){const i=t[o];if(i.options||i.opciones){const l=(i.options||i.opciones).filter(a=>!t[a.scene||a.escena]);n=[...n,...l.map(a=>`${o} => ${a.btn} => ${a.scene||a.escena}`)]}else{if(i.deadEnd||i.sinSalida)continue;t[i.scene||i.escena]||n.push(`${o} => ${i.scene||i.escena}`)}}if(n.length>0){const o=this.lang==="es"?`Las siguientes escenas no llevan a ningún lado: ${n.join(", ")}`:`The following scenes are dead ends: ${n.join(", ")}`;console.error(o),this.scenesError=!0}return this}testGrammar(e){const t=e||this.grammar;if(!t){const n=this.lang==="es"?"No hay gramática para probar":"There is not grammar to test";console.error(n)}for(let n of Object.keys(t)){const o=t[n];for(let i of o){const r=i.match(/<([\w\d]+)>/gi),l=r?r.map(c=>c.replace(/[<>]/g,"")):[],a=i.match(/\$[\w\d]+\$\[([\w\d.,:]+)\]/gi),f=a?a.map(c=>c.match(/([ ]?:[\w\d]+)/g).map(d=>/[ ]?:(?<key>[\w\d]+)/.exec(d).groups.key)).reduce((c,d)=>[...c,...d],[]):[],u=[...l,...f].filter(c=>!t[c]);if(u.length>0){const c=this.lang==="es"?`Las siguientes reglas, que se referencian en "${n}", no existen: ${u.join(", ")}`:`The following rules, referenced in "${n}", do not exist: ${u.join(", ")}`;this.grammarError=!0,console.error(c)}}}return this}testDistribution(e){const t=e||this.markov;if(t===void 0){const f=this.lang==="es"?"No hay modelo Markov para probar":"There is not Markov model to test";console.error(f)}const n={},o={};let i=0;const r=Object.values(t);for(let f of r)for(let u of f.probs){const c=(Math.round(u/.05)*.05).toFixed(2);o[i]=c,i++,n[c]===void 0?n[c]=1:n[c]++}console.log("------------------------------------ DIST ------------------------------------");const l=Math.max(...Object.values(n)),a=Object.entries(n).sort((f,u)=>f[0]>u[0]?1:f[0]<u[0]?-1:0);for(let f of a)console.log(`${f[0]}... ${"|".repeat(Math.ceil(f[1]*100/l))}`);return console.log("------------------------------------ DIST ------------------------------------"),this}async showIgrama(e,t="png",n){const o=await this.igramaDataUrl(e,t),i=new Image;i.src=o,n==null?document.body.appendChild(i):document.getElementById(n).appendChild(i)}async igramaDataUrl(e,t="png"){const n=this.igrama.metadata.width,o=this.igrama.metadata.height;let i=document.createElement("canvas");i.width=n,i.height=o;const r=i.getContext("2d");r.lineJoin="round",r.lineCap="round",r.fillStyle=this.igrama.metadata.bg||"#FFFFFF",r.fillRect(0,0,n,o),await this.drawLayers(e,r);let l;if(t==="png")l=i.toDataURL();else if(t==="gif"){if(typeof MiniGif>"u")return console.error(this.lang==="es"?"Para crear Gifs debes tener también la librería MiniGif":"To create Gifs you must have also the MiniGif library"),"";const a={colorResolution:7,dither:!1,delay:50};Object.assign(a,this.minigifOptions);const f=new MiniGif(a);f.addFrame(i);const u=this.getLayerWiggle(e);r.fillStyle=this.igrama.metadata.bg||"#FFFFFF",r.fillRect(0,0,n,o),await this.drawLayers(u,r),f.addFrame(i);const c=f.makeGif();l="data:image/gif;base64,"+await this.base64_arraybuffer(c)}return i.remove(),l}async base64_arraybuffer(e){return(await new Promise(n=>{const o=new FileReader;o.onload=()=>n(o.result),o.readAsDataURL(new Blob([e]))})).split(",",2)[1]}getLayerWiggle(e){const n=JSON.parse(JSON.stringify(e)),o=(i,r)=>Math.floor(i+Math.random()*(r-i));for(let[i,r]of n.entries())if(r.type==="vector")for(let[l,a]of r.content.entries()){for(let[f,u]of a.entries())Math.random()<.5?u[0]+=o(-3,3):u[1]+=o(-3,3);a.color=e[i].content[l].color,a.weight=e[i].content[l].weight}return n}getIgramaText(e){return e.map(n=>n.attribute).reverse().join(" ").trim()}async drawLayers(e,t){for(let[n,o]of e.entries())if(o.type==="url"){const{w:i,h:r,x:l,y:a}=this.igrama.sections[n];if(this.imgsMemo[o.content]===void 0){const f=new Image;f.src=o.content,this.imgsMemo[o.content]=await new Promise(u=>{f.addEventListener("load",()=>{u(f)},!1)})}t.drawImage(this.imgsMemo[o.content],l,a,i,r)}else if(o.type=="vector")for(let i of o.content){if(i.length===0)continue;const r=this.getSpline(i);this.drawSpline(r,t,i.color,i.weight)}}drawSpline(e,t,n,o){t.lineWidth=o,t.strokeStyle=n,t.fillStyle="rgba(0,0,0,0)",t.beginPath();for(let i=0;i<e.length;i++)i===0?t.moveTo(...e[0]):t.lineTo(...e[i]);t.stroke()}getSpline(e){let t=[];for(let n=0;n<e.length-1;n++){const o=[];o[0]=n>0?e[n-1]:e[0],o[1]=e[n],o[2]=e[n+1],o[3]=n<e.length-2?e[n+2]:e[e.length-1];for(let i=0;i<1;i+=.05){const r=this.getSplinePoint(i,o);t.push(r)}}return t}getSplinePoint(e,t){const n=Math.floor(e)+1,o=n+1,i=o+1,r=n-1,l=e*e,a=l*e,f=-a+2*l-e,u=3*a-5*l+2,c=-3*a+4*l+e,d=a-l,h=.5*(t[r][0]*f+t[n][0]*u+t[o][0]*c+t[i][0]*d),S=.5*(t[r][1]*f+t[n][1]*u+t[o][1]*c+t[i][1]*d);return[h,S]}setCSS(){const e=document.createElement("style");e.id="adventurestyle",e.innerHTML=an,document.getElementsByTagName("head")[0].appendChild(e)}}async function on(s,e,t,n,o=()=>{}){const i=[e.find(w=>w.ID==t),e.find(w=>w.ID==n)],r=s.options.vizWidth,l=s.options.vizHeight;let a=0;const f=[];for(let w of i){const E=new Image;E.setAttribute("crossorigin","anonymous"),E.src=w.IMGURL,await new Promise(y=>{E.onload=()=>{y(!0)}}),f.push({url:w.IMGURL,img:E,ID:w.ID}),o(a/i.length),a++}const u=document.createElement("canvas"),c=u.getContext("2d");u.width=r,u.height=l,c.fillStyle=s.options.vizBg,c.fillRect(0,0,r,l);const d=[];let h=0;for(let w of f){const E=parseInt(r/2)*.1,y=parseInt(r/2)-E,m=parseInt(y*w.img.height/w.img.width),b=h*(y+E)+y/2+E/2,g=l/2;c.save(),c.translate(-y/2,-m/2),c.drawImage(w.img,b,g,y,m),c.restore();const k={x:b,y:g,w:y,h:m,btn:"",scene:`ind_${w.ID}`,tooltip:""};d.push(k),h++}const S=u.toDataURL("image/png");return u.remove(),{viz:S,areas:d}}async function rn(s,e,t,n,o=()=>{}){const i=s.options.vizWidth,r=s.options.vizHeight,l=s.options.vizImageSize,a={l:.2*i,r:.1*i,t:.1*r,b:.1*r},f=i-a.l-a.r,u=r-a.t-a.b,c=e,d=[...new Set(c.map(I=>I[t]))],h=[...new Set(c.map(I=>I[n]))],S=d3.scalePoint().domain(d).range([0,f]).padding(.5).round(!0),w=d3.scalePoint().domain(h).range([0,u]).padding(.5).round(!0);let E=0;const y=[];for(let I of c){if(s.imgsMemo[I.IMGURL]===void 0){const W=new Image;W.setAttribute("crossorigin","anonymous"),W.src=I.IMGURL,s.imgsMemo[I.IMGURL]=await new Promise(q=>{W.onload=()=>{q(W)}})}y.push({url:I.IMGURL,x:S(I[t]),y:w(I[n]),img:s.imgsMemo[I.IMGURL],r:l,ID:I.ID}),o(E/c.length),E++}d3.forceSimulation(y).force("charge",d3.forceManyBody().strength(5)).force("collide",d3.forceCollide(10)).tick(200);const m=document.createElement("canvas"),b=m.getContext("2d");m.width=i,m.height=r,b.fillStyle=s.options.vizBg,b.fillRect(0,0,i,r),b.strokeStyle=s.options.vizCol,b.font="14px serif",b.textBaseline="middle",b.textAlign="center";for(let I of d)b.fillStyle=s.options.vizCol,b.fillText(I,a.l+S(I),a.t+u+a.b/2);b.beginPath(),b.moveTo(a.l,a.t+u),b.lineTo(a.l+f,a.t+u),b.stroke(),b.textAlign="right";for(let I of h)b.fillStyle=s.options.vizCol,b.fillText(I,a.l-5,a.t+w(I));b.beginPath(),b.moveTo(a.l,a.t),b.lineTo(a.l,a.t+u),b.stroke(),b.strokeStyle=s.options.vizCol;const g=[];for(let I of y){const W=l,q=W*I.img.height/I.img.width,Z=I.x+a.l,ee=I.y+a.t;b.save(),b.translate(-W/2,-q/2),b.drawImage(I.img,Z,ee,W,q),b.restore();const R={x:Z,y:ee,w:W,h:q,btn:"",scene:`ind_${I.ID}`,tooltip:""};g.push(R)}const k=m.toDataURL("image/png");return m.remove(),{viz:k,areas:g}}async function ln(s,e,t,n,o=()=>{}){const i=s.options.vizWidth,r=s.options.vizHeight,l=e,a=d3.rollup(l,g=>g.length,g=>g[t],g=>g[n]),f=([g,k])=>k.size&&Array.from(k),u=d3.hierarchy(a,f).sum(([,g])=>g).sort((g,k)=>k.value-g.value),c=[...d3.schemeGreys[4]].reverse(),d=u.descendants(),h=g=>c[g];d3.pack(u).size([i,r]).padding(20)(u);const S=[];let w=0;for(let g of l){for(let k of u.leaves())if(g[t]===k.parent.data[0]&&g[n]===k.data[0]){if(s.imgsMemo[g.IMGURL]===void 0){const I=new Image;I.setAttribute("crossorigin","anonymous"),I.src=g.IMGURL,s.imgsMemo[g.IMGURL]=await new Promise(W=>{I.onload=()=>{W(I)}})}S.push({url:g.IMGURL,x:k.x,y:k.y,r:s.options.vizImageSize,img:s.imgsMemo[g.IMGURL],ID:g.ID})}o(w/l.length),w++}d3.forceSimulation(S).force("collide",d3.forceCollide(20)).tick(200);const E=document.createElement("canvas"),y=E.getContext("2d");E.width=i,E.height=r,y.fillStyle=s.options.vizBg,y.fillRect(0,0,i,r),y.font="12px serif",y.textBaseline="middle",y.textAlign="center";for(let g of d)y.save(),y.translate(g.x,g.y),y.strokeStyle=s.options.vizCol,y.fillStyle=h(g.depth),y.beginPath(),y.ellipse(0,0,g.r,g.r,0,0,Math.PI*2),y.fill(),y.stroke(),y.fillStyle=s.options.vizCol,y.fillText(g.depth===1||g.depth===2?g.data[0]:"",0,-g.r-5),y.restore();const m=[];for(let g of S){const k=parseInt(50),I=parseInt(k*g.img.height/g.img.width),W=g.x,q=g.y;y.save(),y.translate(-k/2,-I/2),y.drawImage(g.img,W,q,k,I),y.restore();const Z={x:W,y:q,w:k,h:I,btn:"",scene:`ind_${g.ID}`,tooltip:""};m.push(Z)}const b=E.toDataURL("image/png");return E.remove(),{viz:b,areas:m}}const an=`#storygeneraldiv {
  box-sizing: border-box;
  margin: auto;
  max-width: 600px;
  font-family: 'Courier New', Courier, monospace;
  background: white;
}

.storydiv {
  box-sizing: border-box;
  border: solid black 1px;
  width: 100%;
  display: flex;
  padding: 1em;
  flex-direction: column;
}

.storytitle {
  font-size: 2em;
  margin: 0.1em 0;
}

.storyp {
  font-size: 1em;
}

.storymeta-container {
  margin: 0.5em 0;
}

.storymeta-key {
  font-weight: 700;
}

.storybutton-container {
  margin: auto;
}

.storybutton {
  background: white;
  box-shadow: none;
  border: solid 1px;
  margin: 0px 1em 0px 0px;
  font-size: 20px;
  font-family: 'Courier New', Courier, monospace;
  cursor: pointer;
}

.storybutton:hover {
  color: white;
  background: black;
}

.storyimage-container {
  box-sizing: content-box;
  position: relative;
  width: 100%;
  margin: auto;
}

.storyimage {
  justify-content: center;
  width: 100%;
  margin: auto;
  border-radius: 20px;
  display: block;
}

.storyimage-area {
  box-sizing: border-box;
  position: absolute;
  cursor: pointer;
  text-align: center;
  color: black;
  background: #ffffff00;
  border: solid 1px black;
}

.storyimage-area:hover {
  background: #ffffff33;
}

@media screen and (max-device-width: 500px) {
  #storygeneraldiv {
    max-width:100%;
  }
  .storyp {
    font-size: 7vw;
  }
  .storybutton {
    font-size: 10vw;
  }
}
`,Qt=Ge(sn);function ht(s){let e,t,n,o,i,r,l,a,f,u,c,d,h,S,w,E,y,m,b,g,k,I,W,q,Z=s[2].typewriterSpeed+"",ee,R,z,G,V,J,O,Y,ne,K,se,j,X,x,ie,N,B,D,Q,ae,re,Ee,De,Ae;return{c(){e=T("div"),t=T("div"),n=T("div"),o=T("label"),i=F("Botón regresar:"),r=A(),l=T("input"),f=A(),u=T("div"),c=T("label"),d=F("Botón reiniciar:"),h=A(),S=T("input"),E=A(),y=T("div"),m=T("label"),b=F("Intervalo texto:"),g=A(),k=T("input"),W=A(),q=T("span"),ee=F(Z),R=A(),z=T("div"),G=T("label"),V=F("Deslizar a imagen:"),J=A(),O=T("input"),ne=A(),K=T("div"),se=T("label"),j=F("Modo rollo:"),X=A(),x=T("input"),N=A(),B=T("div"),D=T("label"),Q=F("Evaluar etiquetas HTML:"),ae=A(),re=T("input"),this.h()},l(me){e=C(me,"DIV",{class:!0});var ce=M(e);t=C(ce,"DIV",{class:!0});var ge=M(t);n=C(ge,"DIV",{class:!0});var Le=M(n);o=C(Le,"LABEL",{for:!0,class:!0});var Ve=M(o);i=H(Ve,"Botón regresar:"),Ve.forEach(_),r=L(Le),l=C(Le,"INPUT",{type:!0,id:!0,class:!0}),Le.forEach(_),f=L(ge),u=C(ge,"DIV",{class:!0});var Ue=M(u);c=C(Ue,"LABEL",{for:!0,class:!0});var Xe=M(c);d=H(Xe,"Botón reiniciar:"),Xe.forEach(_),h=L(Ue),S=C(Ue,"INPUT",{type:!0,id:!0,class:!0}),Ue.forEach(_),E=L(ge),y=C(ge,"DIV",{class:!0});var Be=M(y);m=C(Be,"LABEL",{for:!0,class:!0});var rt=M(m);b=H(rt,"Intervalo texto:"),rt.forEach(_),g=L(Be),k=C(Be,"INPUT",{type:!0,id:!0,min:!0,max:!0,class:!0}),W=L(Be),q=C(Be,"SPAN",{});var lt=M(q);ee=H(lt,Z),lt.forEach(_),Be.forEach(_),R=L(ge),z=C(ge,"DIV",{class:!0});var $e=M(z);G=C($e,"LABEL",{for:!0,class:!0});var at=M(G);V=H(at,"Deslizar a imagen:"),at.forEach(_),J=L($e),O=C($e,"INPUT",{type:!0,id:!0,class:!0}),$e.forEach(_),ne=L(ge),K=C(ge,"DIV",{class:!0});var et=M(K);se=C(et,"LABEL",{for:!0,class:!0});var ct=M(se);j=H(ct,"Modo rollo:"),ct.forEach(_),X=L(et),x=C(et,"INPUT",{type:!0,id:!0,class:!0}),et.forEach(_),N=L(ge),B=C(ge,"DIV",{class:!0});var tt=M(B);D=C(tt,"LABEL",{for:!0,class:!0});var ut=M(D);Q=H(ut,"Evaluar etiquetas HTML:"),ut.forEach(_),ae=L(tt),re=C(tt,"INPUT",{type:!0,id:!0,class:!0}),tt.forEach(_),ge.forEach(_),ce.forEach(_),this.h()},h(){p(o,"for","back"),p(o,"class","svelte-1ltqifr"),p(l,"type","checkbox"),p(l,"id","back"),l.checked=a=s[2].backBtn,p(l,"class","svelte-1ltqifr"),p(n,"class","option svelte-1ltqifr"),p(c,"for","back"),p(c,"class","svelte-1ltqifr"),p(S,"type","checkbox"),p(S,"id","back"),S.checked=w=s[2].restartBtn,p(S,"class","svelte-1ltqifr"),p(u,"class","option svelte-1ltqifr"),p(m,"for","speed"),p(m,"class","svelte-1ltqifr"),p(k,"type","range"),p(k,"id","speed"),p(k,"min","0"),p(k,"max","80"),k.value=I=s[2].typewriterSpeed,p(k,"class","svelte-1ltqifr"),p(y,"class","option svelte-1ltqifr"),p(G,"for","slide"),p(G,"class","svelte-1ltqifr"),p(O,"type","checkbox"),p(O,"id","slide"),O.checked=Y=s[2].adventureSlide,p(O,"class","svelte-1ltqifr"),p(z,"class","option svelte-1ltqifr"),p(se,"for","roll"),p(se,"class","svelte-1ltqifr"),p(x,"type","checkbox"),p(x,"id","roll"),x.checked=ie=s[2].adventureScroll,p(x,"class","svelte-1ltqifr"),p(K,"class","option svelte-1ltqifr"),p(D,"for","eval"),p(D,"class","svelte-1ltqifr"),p(re,"type","checkbox"),p(re,"id","eval"),re.checked=Ee=s[2].evalTags,p(re,"class","svelte-1ltqifr"),p(B,"class","option svelte-1ltqifr"),p(t,"class","scene-toolbar subtoolbar svelte-1ltqifr"),p(e,"class","toolbar svelte-1ltqifr")},m(me,ce){U(me,e,ce),v(e,t),v(t,n),v(n,o),v(o,i),v(n,r),v(n,l),v(t,f),v(t,u),v(u,c),v(c,d),v(u,h),v(u,S),v(t,E),v(t,y),v(y,m),v(m,b),v(y,g),v(y,k),v(y,W),v(y,q),v(q,ee),v(t,R),v(t,z),v(z,G),v(G,V),v(z,J),v(z,O),v(t,ne),v(t,K),v(K,se),v(se,j),v(K,X),v(K,x),v(t,N),v(t,B),v(B,D),v(D,Q),v(B,ae),v(B,re),De||(Ae=[P(l,"click",s[14]),P(S,"click",s[15]),P(k,"input",s[16]),P(O,"click",s[17]),P(x,"click",s[18]),P(re,"click",s[19])],De=!0)},p(me,ce){ce&4&&a!==(a=me[2].backBtn)&&(l.checked=a),ce&4&&w!==(w=me[2].restartBtn)&&(S.checked=w),ce&4&&I!==(I=me[2].typewriterSpeed)&&(k.value=I),ce&4&&Z!==(Z=me[2].typewriterSpeed+"")&&Fe(ee,Z),ce&4&&Y!==(Y=me[2].adventureSlide)&&(O.checked=Y),ce&4&&ie!==(ie=me[2].adventureScroll)&&(x.checked=ie),ce&4&&Ee!==(Ee=me[2].evalTags)&&(re.checked=Ee)},d(me){me&&_(e),De=!1,ze(Ae)}}}function cn(s){let e,t,n,o,i,r,l,a,f,u,c,d,h,S,w,E,y,m,b,g,k,I,W,q,Z,ee,R,z,G,V=s[1]&&ht(s);return{c(){e=T("div"),t=T("input"),n=A(),o=T("div"),i=T("button"),r=F("Nuevo proyecto"),l=A(),a=T("label"),f=F("Importar"),u=A(),c=T("button"),d=F("Exportar"),h=A(),S=T("button"),w=F("Previsualizar"),E=A(),y=T("button"),m=F("Generar interactivo final"),b=A(),g=T("button"),k=F("Opciones"),I=A(),W=T("div"),q=T("button"),Z=F("Nueva escena"),ee=A(),V&&V.c(),R=_e(),this.h()},l(J){e=C(J,"DIV",{class:!0});var O=M(e);t=C(O,"INPUT",{type:!0,id:!0,class:!0}),n=L(O),o=C(O,"DIV",{class:!0});var Y=M(o);i=C(Y,"BUTTON",{class:!0});var ne=M(i);r=H(ne,"Nuevo proyecto"),ne.forEach(_),l=L(Y),a=C(Y,"LABEL",{class:!0,for:!0});var K=M(a);f=H(K,"Importar"),K.forEach(_),u=L(Y),c=C(Y,"BUTTON",{class:!0});var se=M(c);d=H(se,"Exportar"),se.forEach(_),h=L(Y),S=C(Y,"BUTTON",{class:!0});var j=M(S);w=H(j,"Previsualizar"),j.forEach(_),E=L(Y),y=C(Y,"BUTTON",{class:!0});var X=M(y);m=H(X,"Generar interactivo final"),X.forEach(_),b=L(Y),g=C(Y,"BUTTON",{class:!0});var x=M(g);k=H(x,"Opciones"),x.forEach(_),Y.forEach(_),I=L(O),W=C(O,"DIV",{class:!0});var ie=M(W);q=C(ie,"BUTTON",{class:!0});var N=M(q);Z=H(N,"Nueva escena"),N.forEach(_),ie.forEach(_),O.forEach(_),ee=L(J),V&&V.l(J),R=_e(),this.h()},h(){p(t,"type","file"),p(t,"id","load-input"),t.hidden=!0,p(t,"class","svelte-1ltqifr"),p(i,"class","toolbar-button svelte-1ltqifr"),p(a,"class","toolbar-button svelte-1ltqifr"),p(a,"for","load-input"),p(c,"class","toolbar-button svelte-1ltqifr"),p(S,"class","toolbar-button svelte-1ltqifr"),p(y,"class","toolbar-button svelte-1ltqifr"),p(g,"class","toolbar-button svelte-1ltqifr"),p(o,"class","project-toolbar subtoolbar svelte-1ltqifr"),p(q,"class","toolbar-button svelte-1ltqifr"),p(W,"class","scene-toolbar subtoolbar svelte-1ltqifr"),p(e,"class","toolbar svelte-1ltqifr")},m(J,O){U(J,e,O),v(e,t),s[13](t),v(e,n),v(e,o),v(o,i),v(i,r),v(o,l),v(o,a),v(a,f),v(o,u),v(o,c),v(c,d),v(o,h),v(o,S),v(S,w),v(o,E),v(o,y),v(y,m),v(o,b),v(o,g),v(g,k),v(e,I),v(e,W),v(W,q),v(q,Z),U(J,ee,O),V&&V.m(J,O),U(J,R,O),z||(G=[P(t,"change",s[6]),P(i,"click",s[5]),P(c,"click",s[7]),P(S,"click",s[8]),P(y,"click",s[9]),P(g,"click",s[4]),P(q,"click",s[3])],z=!0)},p(J,[O]){J[1]?V?V.p(J,O):(V=ht(J),V.c(),V.m(R.parentNode,R)):V&&(V.d(1),V=null)},i:Oe,o:Oe,d(J){J&&_(e),s[13](null),J&&_(ee),V&&V.d(J),J&&_(R),z=!1,ze(G)}}}function un(s,e,t){let n,o,i,r,l,a;oe(s,ot,z=>t(2,n=z)),oe(s,en,z=>t(20,o=z)),oe(s,nn,z=>t(21,i=z)),oe(s,le,z=>t(22,r=z)),oe(s,Qt,z=>t(23,l=z)),oe(s,$t,z=>t(24,a=z));let{showNewScene:f}=e,{showTest:u}=e,c,d=!1;function h(){t(11,f=!0)}function S(){t(1,d=!d)}function w(){ve(le,r={},r)}function E(){w();const z=c.files[0];if(z.type==="application/json"){const G=new FileReader;G.addEventListener("load",function(){ve(le,r={},r);const V=G.result,J=JSON.parse(V);ve(le,r=J,r)}),this.value=null,G.readAsText(z);return}else alert("Formato de archivo incorrecto / incorrect file format")}function y(){a(r,"aventuraInteractiva")}function m(){t(12,u=!0)}function b(){const z=Object.entries(r).sort((Y,ne)=>Y[1].display.y-ne[1].display.y);if(z.length===0){alert("No hay escenas / There are no scenes");return}const G=l.toString(),V=JSON.stringify(r),J=JSON.stringify(n),O=i(G,V,z[0][0],J);o(O)}function g(z,G){ve(ot,n[z]=G,n)}function k(z){ue[z?"unshift":"push"](()=>{c=z,t(0,c)})}const I=z=>{g("backBtn",z.target.checked)},W=z=>{g("restartBtn",z.target.checked)},q=z=>{g("typewriterSpeed",+z.target.value)},Z=z=>{g("adventureSlide",z.target.checked)},ee=z=>{g("adventureScroll",z.target.checked)},R=z=>{g("evalTags",z.target.checked)};return s.$$set=z=>{"showNewScene"in z&&t(11,f=z.showNewScene),"showTest"in z&&t(12,u=z.showTest)},[c,d,n,h,S,w,E,y,m,b,g,f,u,k,I,W,q,Z,ee,R]}class fn extends Te{constructor(e){super(),Ce(this,e,un,cn,Ne,{showNewScene:11,showTest:12})}}function dn(s){let e,t,n,o;const i=s[5].default,r=Kt(i,s,s[4],null);return{c(){e=T("div"),r&&r.c(),this.h()},l(l){e=C(l,"DIV",{class:!0,key:!0});var a=M(e);r&&r.l(a),a.forEach(_),this.h()},h(){p(e,"class","scene-node-container svelte-sua7yb"),p(e,"key",s[0])},m(l,a){U(l,e,a),r&&r.m(e,null),t=!0,n||(o=He(s[1].call(null,e)),n=!0)},p(l,[a]){r&&r.p&&(!t||a&16)&&Ft(r,i,l,l[4],t?Jt(i,l[4],a,null):Ht(l[4]),null),(!t||a&1)&&p(e,"key",l[0])},i(l){t||($(r,l),t=!0)},o(l){te(r,l),t=!1},d(l){l&&_(e),r&&r.d(l),n=!1,o()}}}function hn(s,e,t){let{$$slots:n={},$$scope:o}=e,{scene:i}=e,{movingNode:r=!1}=e,{key:l}=e;function a(f){let u=!1;f.style.left=`${i.display.x}px`,f.style.top=`${i.display.y}px`,f.addEventListener("mousedown",()=>{u=!0,t(3,r=!0)}),window.addEventListener("mousemove",c=>{u&&(t(2,i.display.x+=c.movementX,i),t(2,i.display.y+=c.movementY,i),f.style.left=`${i.display.x}px`,f.style.top=`${i.display.y}px`)}),window.addEventListener("mouseup",()=>{u=!1,t(3,r=!1)})}return s.$$set=f=>{"scene"in f&&t(2,i=f.scene),"movingNode"in f&&t(3,r=f.movingNode),"key"in f&&t(0,l=f.key),"$$scope"in f&&t(4,o=f.$$scope)},[l,a,i,r,o,n]}class pn extends Te{constructor(e){super(),Ce(this,e,hn,dn,Ne,{scene:2,movingNode:3,key:0})}}function mn(s){let e,t,n,o;const i=s[5].default,r=Kt(i,s,s[4],null);return{c(){e=T("div"),r&&r.c(),this.h()},l(l){e=C(l,"DIV",{class:!0});var a=M(e);r&&r.l(a),a.forEach(_),this.h()},h(){p(e,"class","draggui svelte-lq1cua")},m(l,a){U(l,e,a),r&&r.m(e,null),t=!0,n||(o=[He(s[0].call(null,e)),He(s[1].call(null,e)),P(e,"mousedown",we(s[6]))],n=!0)},p(l,[a]){r&&r.p&&(!t||a&16)&&Ft(r,i,l,l[4],t?Jt(i,l[4],a,null):Ht(l[4]),null)},i(l){t||($(r,l),t=!0)},o(l){te(r,l),t=!1},d(l){l&&_(e),r&&r.d(l),n=!1,ze(o)}}}function gn(s,e,t){let{$$slots:n={},$$scope:o}=e,{pos:i}=e,{displace:r={x:i.x,y:i.y}}=e;function l(u){u.style.left=`${r.x}px`,u.style.top=`${r.y}px`}function a(u){let c=!1;u.style.left=`${r.x}px`,u.style.top=`${r.y}px`,u.addEventListener("mousedown",()=>{c=!0}),window.addEventListener("mousemove",d=>{c&&(t(2,r.x+=d.movementX,r),t(2,r.y+=d.movementY,r),u.style.left=`${r.x}px`,u.style.top=`${r.y}px`,u.style.cursor="grabbing")}),window.addEventListener("mouseup",()=>{c=!1,u.style.cursor="grab"})}function f(u){ye.call(this,s,u)}return s.$$set=u=>{"pos"in u&&t(3,i=u.pos),"displace"in u&&t(2,r=u.displace),"$$scope"in u&&t(4,o=u.$$scope)},[l,a,r,i,o,n,f]}class Qe extends Te{constructor(e){super(),Ce(this,e,gn,mn,Ne,{pos:3,displace:2})}}function vn(s){let e,t,n,o,i;return{c(){e=T("div"),t=T("button"),n=F("X"),this.h()},l(r){e=C(r,"DIV",{class:!0});var l=M(e);t=C(l,"BUTTON",{class:!0});var a=M(t);n=H(a,"X"),a.forEach(_),l.forEach(_),this.h()},h(){p(t,"class","x-button"),p(e,"class","top-bar svelte-15bdkib")},m(r,l){U(r,e,l),v(e,t),v(t,n),o||(i=P(t,"click",s[0]),o=!0)},p:Oe,i:Oe,o:Oe,d(r){r&&_(e),o=!1,i()}}}function _n(s,e,t){let{toggle:n}=e;function o(){t(1,n=!1)}return s.$$set=i=>{"toggle"in i&&t(1,n=i.toggle)},[o,n]}class xe extends Te{constructor(e){super(),Ce(this,e,_n,vn,Ne,{toggle:1})}}function bn(s){let e,t,n,o,i,r,l,a,f,u,c,d,h,S,w;function E(m){s[7](m)}let y={};return s[0]!==void 0&&(y.toggle=s[0]),e=new xe({props:y}),ue.push(()=>ke(e,"toggle",E)),{c(){fe(e.$$.fragment),n=A(),o=T("div"),i=T("label"),r=F("Btn:"),l=A(),a=T("input"),f=A(),u=T("div"),c=T("button"),d=F("Aceptar"),this.h()},l(m){de(e.$$.fragment,m),n=L(m),o=C(m,"DIV",{});var b=M(o);i=C(b,"LABEL",{for:!0});var g=M(i);r=H(g,"Btn:"),g.forEach(_),l=L(b),a=C(b,"INPUT",{id:!0,type:!0}),b.forEach(_),f=L(m),u=C(m,"DIV",{class:!0});var k=M(u);c=C(k,"BUTTON",{class:!0});var I=M(c);d=H(I,"Aceptar"),I.forEach(_),k.forEach(_),this.h()},h(){p(i,"for","inp"),p(a,"id","inp"),p(a,"type","text"),a.autofocus=!0,p(c,"class","gui-button"),p(u,"class","bar svelte-1bhrmvp")},m(m,b){he(e,m,b),U(m,n,b),U(m,o,b),v(o,i),v(i,r),v(o,l),v(o,a),Ie(a,s[2]),U(m,f,b),U(m,u,b),v(u,c),v(c,d),h=!0,a.focus(),S||(w=[P(a,"input",s[8]),P(a,"mousedown",we(s[6])),P(c,"click",s[3])],S=!0)},p(m,b){const g={};!t&&b&1&&(t=!0,g.toggle=m[0],Se(()=>t=!1)),e.$set(g),b&4&&a.value!==m[2]&&Ie(a,m[2])},i(m){h||($(e.$$.fragment,m),h=!0)},o(m){te(e.$$.fragment,m),h=!1},d(m){pe(e,m),m&&_(n),m&&_(o),m&&_(f),m&&_(u),S=!1,ze(w)}}}function yn(s){let e,t,n,o;return e=new Qe({props:{pos:s[1],$$slots:{default:[bn]},$$scope:{ctx:s}}}),{c(){fe(e.$$.fragment)},l(i){de(e.$$.fragment,i)},m(i,r){he(e,i,r),t=!0,n||(o=P(window,"keydown",s[4]),n=!0)},p(i,[r]){const l={};r&2&&(l.pos=i[1]),r&4101&&(l.$$scope={dirty:r,ctx:i}),e.$set(l)},i(i){t||($(e.$$.fragment,i),t=!0)},o(i){te(e.$$.fragment,i),t=!1},d(i){pe(e,i),n=!1,o()}}}function wn(s,e,t){let n,o,i;oe(s,le,w=>t(9,o=w)),oe(s,st,w=>t(10,i=w));let{key:r}=e,{pos:l}=e,{showNewOption:a}=e;const f=i(o[r]);function u(){o[r][f]===void 0&&ve(le,o[r][f]=[],o),o[r][f].push({btn:n}),le.set(o),t(0,a=!1)}function c(w){w.key==="Enter"&&u(),w.key==="Escape"&&t(0,a=!1)}function d(w){ye.call(this,s,w)}function h(w){a=w,t(0,a)}function S(){n=this.value,t(2,n)}return s.$$set=w=>{"key"in w&&t(5,r=w.key),"pos"in w&&t(1,l=w.pos),"showNewOption"in w&&t(0,a=w.showNewOption)},t(2,n=""),[a,l,n,u,c,r,d,h,S]}class kn extends Te{constructor(e){super(),Ce(this,e,wn,yn,Ne,{key:5,pos:1,showNewOption:0})}}function pt(s){let e,t,n,o;return{c(){e=T("div"),t=F(s[8]),this.h()},l(i){e=C(i,"DIV",{class:!0});var r=M(e);t=H(r,s[8]),r.forEach(_),this.h()},h(){p(e,"class","area svelte-1picauk")},m(i,r){U(i,e,r),v(e,t),s[23](e),n||(o=P(e,"mousedown",we(s[14])),n=!0)},p(i,r){r&256&&Fe(t,i[8])},d(i){i&&_(e),s[23](null),n=!1,o()}}}function Sn(s){let e,t,n,o,i,r,l,a,f,u,c,d,h,S,w,E,y,m,b,g,k,I,W,q,Z,ee,R,z,G,V,J,O,Y,ne,K,se,j,X,x;function ie(D){s[18](D)}let N={};s[0]!==void 0&&(N.toggle=s[0]),e=new xe({props:N}),ue.push(()=>ke(e,"toggle",ie));let B=s[5]&&pt(s);return{c(){fe(e.$$.fragment),n=A(),o=T("div"),i=T("h1"),r=F(s[1]),l=A(),a=T("div"),f=T("div"),u=T("h2"),c=F("Nombre de referencia"),d=A(),h=T("input"),S=A(),w=T("div"),E=T("h2"),y=F("Btn"),m=A(),b=T("input"),g=A(),k=T("div"),I=T("h2"),W=F("Tooltip"),q=A(),Z=T("input"),ee=A(),R=T("div"),z=T("div"),G=T("div"),V=T("img"),O=A(),B&&B.c(),Y=A(),ne=T("div"),K=T("button"),se=F("Aceptar"),this.h()},l(D){de(e.$$.fragment,D),n=L(D),o=C(D,"DIV",{});var Q=M(o);i=C(Q,"H1",{class:!0});var ae=M(i);r=H(ae,s[1]),ae.forEach(_),Q.forEach(_),l=L(D),a=C(D,"DIV",{class:!0});var re=M(a);f=C(re,"DIV",{class:!0});var Ee=M(f);u=C(Ee,"H2",{class:!0});var De=M(u);c=H(De,"Nombre de referencia"),De.forEach(_),d=L(Ee),h=C(Ee,"INPUT",{}),Ee.forEach(_),S=L(re),w=C(re,"DIV",{class:!0});var Ae=M(w);E=C(Ae,"H2",{class:!0});var me=M(E);y=H(me,"Btn"),me.forEach(_),m=L(Ae),b=C(Ae,"INPUT",{}),Ae.forEach(_),g=L(re),k=C(re,"DIV",{class:!0});var ce=M(k);I=C(ce,"H2",{class:!0});var ge=M(I);W=H(ge,"Tooltip"),ge.forEach(_),q=L(ce),Z=C(ce,"INPUT",{}),ce.forEach(_),re.forEach(_),ee=L(D),R=C(D,"DIV",{class:!0});var Le=M(R);z=C(Le,"DIV",{class:!0});var Ve=M(z);G=C(Ve,"DIV",{class:!0});var Ue=M(G);V=C(Ue,"IMG",{src:!0,alt:!0,class:!0}),O=L(Ue),B&&B.l(Ue),Ue.forEach(_),Ve.forEach(_),Le.forEach(_),Y=L(D),ne=C(D,"DIV",{class:!0});var Xe=M(ne);K=C(Xe,"BUTTON",{class:!0});var Be=M(K);se=H(Be,"Aceptar"),Be.forEach(_),Xe.forEach(_),this.h()},h(){p(i,"class","svelte-1picauk"),p(u,"class","svelte-1picauk"),p(f,"class","input"),p(E,"class","svelte-1picauk"),p(w,"class","input"),p(I,"class","svelte-1picauk"),p(k,"class","input"),p(a,"class","inputs svelte-1picauk"),Ze(V.src,J=s[9][s[10]])||p(V,"src",J),p(V,"alt","Preview"),p(V,"class","img-preview svelte-1picauk"),p(G,"class","area-container"),p(z,"class","area-absolute-container svelte-1picauk"),p(R,"class","area-normal-container svelte-1picauk"),p(K,"class","gui-button"),p(ne,"class","bar")},m(D,Q){he(e,D,Q),U(D,n,Q),U(D,o,Q),v(o,i),v(i,r),U(D,l,Q),U(D,a,Q),v(a,f),v(f,u),v(u,c),v(f,d),v(f,h),Ie(h,s[6]),v(a,S),v(a,w),v(w,E),v(E,y),v(w,m),v(w,b),Ie(b,s[8]),v(a,g),v(a,k),v(k,I),v(I,W),v(k,q),v(k,Z),Ie(Z,s[7]),U(D,ee,Q),U(D,R,Q),v(R,z),v(z,G),v(G,V),s[22](V),v(G,O),B&&B.m(G,null),U(D,Y,Q),U(D,ne,Q),v(ne,K),v(K,se),j=!0,X||(x=[P(h,"input",s[19]),P(h,"mousedown",we(s[17])),P(b,"input",s[20]),P(b,"mousedown",we(s[16])),P(Z,"input",s[21]),P(Z,"mousedown",we(s[15])),He(s[11].call(null,V)),P(z,"mousedown",we(s[13])),P(K,"click",s[12])],X=!0)},p(D,Q){const ae={};!t&&Q&1&&(t=!0,ae.toggle=D[0],Se(()=>t=!1)),e.$set(ae),(!j||Q&2)&&Fe(r,D[1]),Q&64&&h.value!==D[6]&&Ie(h,D[6]),Q&256&&b.value!==D[8]&&Ie(b,D[8]),Q&128&&Z.value!==D[7]&&Ie(Z,D[7]),D[5]?B?B.p(D,Q):(B=pt(D),B.c(),B.m(G,null)):B&&(B.d(1),B=null)},i(D){j||($(e.$$.fragment,D),j=!0)},o(D){te(e.$$.fragment,D),j=!1},d(D){pe(e,D),D&&_(n),D&&_(o),D&&_(l),D&&_(a),D&&_(ee),D&&_(R),s[22](null),B&&B.d(),D&&_(Y),D&&_(ne),X=!1,ze(x)}}}function En(s){let e,t;return e=new Qe({props:{pos:s[2],$$slots:{default:[Sn]},$$scope:{ctx:s}}}),{c(){fe(e.$$.fragment)},l(n){de(e.$$.fragment,n)},m(n,o){he(e,n,o),t=!0},p(n,[o]){const i={};o&4&&(i.pos=n[2]),o&536871419&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){te(e.$$.fragment,n),t=!1},d(n){pe(e,n)}}}function Nn(s,e,t){let n,o,i,r,l,a;oe(s,qe,O=>t(25,r=O)),oe(s,le,O=>t(26,l=O)),oe(s,Yt,O=>t(27,a=O));let{key:f}=e,{pos:u}=e,{showNewArea:c}=e,d,h=l[f];const S=a(h);let w={},E,y;function m(O){let Y=!1;O.addEventListener("mousedown",K=>{K.preventDefault(),Y=!0,t(5,y={x1:K.offsetX,y1:K.offsetY,x2:K.offsetX,y2:K.offsetY})}),O.addEventListener("mousemove",K=>{Y&&b(K)}),O.addEventListener("mouseup",K=>{ne(K)}),O.addEventListener("mouseout",K=>{ne(K)});function ne(K){if(y===void 0||!Y)return;Y=!1;const se=b(K),j={};for(let X of Object.keys(se))j[X]=Math.floor(se[X]*d.naturalWidth/d.width);Object.assign(w,{...j}),w.x=Math.floor(j.x+j.w/2),w.y=Math.floor(j.y+j.h/2)}}function b(O){t(5,y.x2=O.offsetX,y),t(5,y.y2=O.offsetY,y);const Y=Math.min(y.x1,y.x2),ne=Math.max(y.x1,y.x2),K=Math.min(y.y1,y.y2),se=Math.max(y.y1,y.y2),j={x:Y,y:K,w:ne-Y,h:se-K};return t(4,E.style.width=`${j.w}px`,E),t(4,E.style.height=`${j.h}px`,E),t(4,E.style.top=`${j.y}px`,E),t(4,E.style.left=`${j.x}px`,E),j}function g(){if(w===void 0){alert("debes escoger un area / you must choose an area");return}Object.assign(w,{btn:n,tooltip:o,name:i}),l[f].areas===void 0&&ve(le,l[f].areas=[],l),l[f].areas.push(w),le.set(l),t(0,c=!1),ve(qe,r=!r,r)}function k(O){ye.call(this,s,O)}function I(O){ye.call(this,s,O)}function W(O){ye.call(this,s,O)}function q(O){ye.call(this,s,O)}function Z(O){ye.call(this,s,O)}function ee(O){c=O,t(0,c)}function R(){i=this.value,t(6,i)}function z(){n=this.value,t(8,n)}function G(){o=this.value,t(7,o)}function V(O){ue[O?"unshift":"push"](()=>{d=O,t(3,d)})}function J(O){ue[O?"unshift":"push"](()=>{E=O,t(4,E)})}return s.$$set=O=>{"key"in O&&t(1,f=O.key),"pos"in O&&t(2,u=O.pos),"showNewArea"in O&&t(0,c=O.showNewArea)},t(8,n=""),t(7,o=""),t(6,i="area"),[c,f,u,d,E,y,i,o,n,h,S,m,g,k,I,W,q,Z,ee,R,z,G,V,J]}class In extends Te{constructor(e){super(),Ce(this,e,Nn,En,Ne,{key:1,pos:2,showNewArea:0})}}function Tn(s){let e,t,n,o,i,r,l,a,f,u,c;return{c(){e=T("input"),t=A(),n=T("label"),o=F("Cargar archivo"),i=A(),r=T("div"),l=T("img"),this.h()},l(d){e=C(d,"INPUT",{type:!0,id:!0}),t=L(d),n=C(d,"LABEL",{class:!0,for:!0});var h=M(n);o=H(h,"Cargar archivo"),h.forEach(_),i=L(d),r=C(d,"DIV",{class:!0,id:!0});var S=M(r);l=C(S,"IMG",{src:!0,alt:!0,class:!0}),S.forEach(_),this.h()},h(){p(e,"type","file"),p(e,"id","load-image"),e.hidden=!0,p(n,"class","gui-button svelte-1f4uqrr"),p(n,"for","load-image"),Ze(l.src,a=s[0])||p(l,"src",a),p(l,"alt","Preview"),p(l,"class",f=ft(`img-preview ${s[0]?"":"hide"}`)+" svelte-1f4uqrr"),p(r,"class","image-preview-container svelte-1f4uqrr"),p(r,"id","image-preview-container")},m(d,h){U(d,e,h),s[4](e),U(d,t,h),U(d,n,h),v(n,o),U(d,i,h),U(d,r,h),v(r,l),s[5](l),u||(c=P(e,"change",s[3]),u=!0)},p(d,[h]){h&1&&!Ze(l.src,a=d[0])&&p(l,"src",a),h&1&&f!==(f=ft(`img-preview ${d[0]?"":"hide"}`)+" svelte-1f4uqrr")&&p(l,"class",f)},i:Oe,o:Oe,d(d){d&&_(e),s[4](null),d&&_(t),d&&_(n),d&&_(i),d&&_(r),s[5](null),u=!1,c()}}}function Cn(s,e,t){let{imageUrl:n}=e,o,i;function r(){const f=o.files[0];if(f){const u=new FileReader;u.addEventListener("load",function(){i.setAttribute("src",u.result),t(0,n=u.result)}),u.readAsDataURL(f)}}function l(f){ue[f?"unshift":"push"](()=>{o=f,t(1,o)})}function a(f){ue[f?"unshift":"push"](()=>{i=f,t(2,i)})}return s.$$set=f=>{"imageUrl"in f&&t(0,n=f.imageUrl)},[n,o,i,r,l,a]}class Mn extends Te{constructor(e){super(),Ce(this,e,Cn,Tn,Ne,{imageUrl:0})}}function zn(s){let e,t,n,o,i,r,l,a,f,u,c,d,h,S,w,E,y,m,b,g,k,I,W,q,Z,ee,R,z,G,V,J,O;function Y(j){s[8](j)}let ne={};s[0]!==void 0&&(ne.toggle=s[0]),e=new xe({props:ne}),ue.push(()=>ke(e,"toggle",Y));function K(j){s[11](j)}let se={};return s[3]!==void 0&&(se.imageUrl=s[3]),q=new Mn({props:se}),ue.push(()=>ke(q,"imageUrl",K)),{c(){fe(e.$$.fragment),n=A(),o=T("div"),i=T("h1"),r=F(s[1]),l=A(),a=T("div"),f=T("h2"),u=F("Texto"),c=A(),d=T("textarea"),h=A(),S=T("div"),w=T("h2"),E=F("Imagen (opcional)"),y=A(),m=T("div"),b=T("label"),g=F("Url:"),k=A(),I=T("input"),W=F(`
      o
      `),fe(q.$$.fragment),ee=A(),R=T("div"),z=T("button"),G=F("Aceptar"),this.h()},l(j){de(e.$$.fragment,j),n=L(j),o=C(j,"DIV",{});var X=M(o);i=C(X,"H1",{class:!0});var x=M(i);r=H(x,s[1]),x.forEach(_),X.forEach(_),l=L(j),a=C(j,"DIV",{});var ie=M(a);f=C(ie,"H2",{class:!0});var N=M(f);u=H(N,"Texto"),N.forEach(_),c=L(ie),d=C(ie,"TEXTAREA",{class:!0}),M(d).forEach(_),ie.forEach(_),h=L(j),S=C(j,"DIV",{});var B=M(S);w=C(B,"H2",{class:!0});var D=M(w);E=H(D,"Imagen (opcional)"),D.forEach(_),y=L(B),m=C(B,"DIV",{});var Q=M(m);b=C(Q,"LABEL",{for:!0});var ae=M(b);g=H(ae,"Url:"),ae.forEach(_),k=L(Q),I=C(Q,"INPUT",{id:!0,type:!0}),W=H(Q,`
      o
      `),de(q.$$.fragment,Q),Q.forEach(_),ee=L(B),R=C(B,"DIV",{class:!0});var re=M(R);z=C(re,"BUTTON",{class:!0});var Ee=M(z);G=H(Ee,"Aceptar"),Ee.forEach(_),re.forEach(_),B.forEach(_),this.h()},h(){p(i,"class","svelte-8prumv"),p(f,"class","no-select svelte-8prumv"),p(d,"class","svelte-8prumv"),p(w,"class","no-select svelte-8prumv"),p(b,"for","inp"),p(I,"id","inp"),p(I,"type","text"),p(z,"class","gui-button"),p(R,"class","bar")},m(j,X){he(e,j,X),U(j,n,X),U(j,o,X),v(o,i),v(i,r),U(j,l,X),U(j,a,X),v(a,f),v(f,u),v(a,c),v(a,d),Ie(d,s[4]),U(j,h,X),U(j,S,X),v(S,w),v(w,E),v(S,y),v(S,m),v(m,b),v(b,g),v(m,k),v(m,I),Ie(I,s[3]),v(m,W),he(q,m,null),v(S,ee),v(S,R),v(R,z),v(z,G),V=!0,J||(O=[P(d,"input",s[9]),P(d,"mousedown",we(s[7])),P(I,"input",s[10]),P(I,"mousedown",we(s[6])),P(z,"click",s[5])],J=!0)},p(j,X){const x={};!t&&X&1&&(t=!0,x.toggle=j[0],Se(()=>t=!1)),e.$set(x),(!V||X&2)&&Fe(r,j[1]),X&16&&Ie(d,j[4]),X&8&&I.value!==j[3]&&Ie(I,j[3]);const ie={};!Z&&X&8&&(Z=!0,ie.imageUrl=j[3],Se(()=>Z=!1)),q.$set(ie)},i(j){V||($(e.$$.fragment,j),$(q.$$.fragment,j),V=!0)},o(j){te(e.$$.fragment,j),te(q.$$.fragment,j),V=!1},d(j){pe(e,j),j&&_(n),j&&_(o),j&&_(l),j&&_(a),j&&_(h),j&&_(S),pe(q),J=!1,ze(O)}}}function Dn(s){let e,t;return e=new Qe({props:{pos:s[2],$$slots:{default:[zn]},$$scope:{ctx:s}}}),{c(){fe(e.$$.fragment)},l(n){de(e.$$.fragment,n)},m(n,o){he(e,n,o),t=!0},p(n,[o]){const i={};o&4&&(i.pos=n[2]),o&65563&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){te(e.$$.fragment,n),t=!1},d(n){pe(e,n)}}}function On(s,e,t){let n,o,i;oe(s,qe,b=>t(12,o=b)),oe(s,le,b=>t(13,i=b));let{key:r}=e,{pos:l}=e,{showEditor:a}=e,f=null,u=i[r];const c=u.text===void 0&&u.texto!==void 0?"texto":"text";function d(){ve(le,i[r][c]=n,i),f!==null&&ve(le,i[r].image=f,i),t(0,a=!1),ve(qe,o=!o,o)}function h(b){ye.call(this,s,b)}function S(b){ye.call(this,s,b)}function w(b){a=b,t(0,a)}function E(){n=this.value,t(4,n),t(14,u)}function y(){f=this.value,t(3,f)}function m(b){f=b,t(3,f)}return s.$$set=b=>{"key"in b&&t(1,r=b.key),"pos"in b&&t(2,l=b.pos),"showEditor"in b&&t(0,a=b.showEditor)},s.$$.update=()=>{s.$$.dirty&2&&ve(le,i[r]=u,i)},t(4,n=u[c]),[a,r,l,f,n,d,h,S,w,E,y,m]}class An extends Te{constructor(e){super(),Ce(this,e,On,Dn,Ne,{key:1,pos:2,showEditor:0})}}function mt(s,e,t){const n=s.slice();return n[38]=e[t],n[40]=t,n}function gt(s,e,t){const n=s.slice();return n[41]=e[t],n[40]=t,n}function vt(s){let e,t,n,o,i,r,l,a;return{c(){e=T("div"),t=T("img"),o=A(),i=T("button"),r=F("x"),this.h()},l(f){e=C(f,"DIV",{class:!0});var u=M(e);t=C(u,"IMG",{src:!0,alt:!0,class:!0}),o=L(u),i=C(u,"BUTTON",{class:!0});var c=M(i);r=H(c,"x"),c.forEach(_),u.forEach(_),this.h()},h(){Ze(t.src,n=s[6][s[13]])||p(t,"src",n),p(t,"alt","Preview"),p(t,"class","img-preview svelte-cnz2jn"),p(i,"class","x-button image-x-button"),p(e,"class","img-preview-container svelte-cnz2jn")},m(f,u){U(f,e,u),v(e,t),v(e,o),v(e,i),v(i,r),l||(a=P(i,"click",s[23]),l=!0)},p(f,u){u[0]&64&&!Ze(t.src,n=f[6][f[13]])&&p(t,"src",n)},d(f){f&&_(e),l=!1,a()}}}function _t(s){let e,t,n,o,i,r,l,a,f;return{c(){e=T("div"),t=T("span"),n=F("área"),o=A(),i=T("div"),r=T("button"),l=F("+"),this.h()},l(u){e=C(u,"DIV",{});var c=M(e);t=C(c,"SPAN",{class:!0});var d=M(t);n=H(d,"área"),d.forEach(_),o=L(c),i=C(c,"DIV",{class:!0});var h=M(i);r=C(h,"BUTTON",{class:!0});var S=M(r);l=H(S,"+"),S.forEach(_),h.forEach(_),c.forEach(_),this.h()},h(){p(t,"class","btns-name svelte-cnz2jn"),p(r,"class","svelte-cnz2jn"),p(i,"class","node-btns-div svelte-cnz2jn")},m(u,c){U(u,e,c),v(e,t),v(t,n),v(e,o),v(e,i),v(i,r),v(r,l),a||(f=P(r,"click",s[10]),a=!0)},p:Oe,d(u){u&&_(e),a=!1,f()}}}function bt(s,e){let t,n,o,i,r,l,a,f,u,c,d,h,S,w;return{key:s,first:null,c(){t=T("div"),n=T("input"),r=A(),l=T("button"),a=F("x"),u=A(),c=T("div"),this.h()},l(E){t=C(E,"DIV",{class:!0});var y=M(t);n=C(y,"INPUT",{type:!0,class:!0,i:!0}),r=L(y),l=C(y,"BUTTON",{class:!0,i:!0});var m=M(l);a=H(m,"x"),m.forEach(_),u=L(y),c=C(y,"DIV",{type:!0,key:!0,content:!0,class:!0,i:!0}),M(c).forEach(_),y.forEach(_),this.h()},h(){p(n,"type","text"),p(n,"class","output-text svelte-cnz2jn"),n.value=o=e[41].btn,p(n,"i",i=e[40]),p(l,"class","x-button"),p(l,"i",f=e[40]),p(c,"type","ops"),p(c,"key",e[1]),p(c,"content",d=e[41].btn),p(c,"class","connection output option-connection svelte-cnz2jn"),p(c,"i",h=e[40]),p(t,"class","output-container svelte-cnz2jn"),this.first=t},m(E,y){U(E,t,y),v(t,n),v(t,r),v(t,l),v(l,a),v(t,u),v(t,c),S||(w=[He(e[15].call(null,n)),P(n,"change",e[14]),P(n,"mousedown",we(e[27])),P(l,"click",e[21]),P(c,"click",e[18]),P(c,"mousedown",we(e[26]))],S=!0)},p(E,y){e=E,y[0]&6&&o!==(o=e[41].btn)&&n.value!==o&&(n.value=o),y[0]&6&&i!==(i=e[40])&&p(n,"i",i),y[0]&6&&f!==(f=e[40])&&p(l,"i",f),y[0]&2&&p(c,"key",e[1]),y[0]&6&&d!==(d=e[41].btn)&&p(c,"content",d),y[0]&6&&h!==(h=e[40])&&p(c,"i",h)},d(E){E&&_(t),S=!1,ze(w)}}}function yt(s,e){let t,n,o,i,r,l,a,f,u,c,d,h,S,w,E;return{key:s,first:null,c(){t=T("div"),n=T("input"),r=A(),l=T("button"),a=F("x"),u=A(),c=T("div"),S=A(),this.h()},l(y){t=C(y,"DIV",{class:!0});var m=M(t);n=C(m,"INPUT",{type:!0,class:!0,i:!0}),r=L(m),l=C(m,"BUTTON",{class:!0,i:!0});var b=M(l);a=H(b,"x"),b.forEach(_),u=L(m),c=C(m,"DIV",{type:!0,key:!0,content:!0,class:!0,i:!0}),M(c).forEach(_),S=L(m),m.forEach(_),this.h()},h(){p(n,"type","text"),p(n,"class","output-text svelte-cnz2jn"),n.value=o=e[38].name,p(n,"i",i=e[40]),p(l,"class","x-button"),p(l,"i",f=e[40]),p(c,"type","areas"),p(c,"key",e[1]),p(c,"content",d=e[38].name),p(c,"class","connection output area-connection svelte-cnz2jn"),p(c,"i",h=e[40]),p(t,"class","output-container svelte-cnz2jn"),this.first=t},m(y,m){U(y,t,m),v(t,n),v(t,r),v(t,l),v(l,a),v(t,u),v(t,c),v(t,S),w||(E=[He(e[17].call(null,n)),P(n,"change",e[16]),P(n,"mousedown",we(e[25])),P(l,"click",e[22]),P(c,"click",e[18]),P(c,"mousedown",we(e[24]))],w=!0)},p(y,m){e=y,m[0]&6&&o!==(o=e[38].name)&&n.value!==o&&(n.value=o),m[0]&6&&i!==(i=e[40])&&p(n,"i",i),m[0]&6&&f!==(f=e[40])&&p(l,"i",f),m[0]&2&&p(c,"key",e[1]),m[0]&6&&d!==(d=e[38].name)&&p(c,"content",d),m[0]&6&&h!==(h=e[40])&&p(c,"i",h)},d(y){y&&_(t),w=!1,ze(E)}}}function wt(s){let e,t=[],n=new Map,o,i=[],r=new Map,l=s[2][s[1]][s[12]]||[];const a=c=>"op"+c[40];for(let c=0;c<l.length;c+=1){let d=gt(s,l,c),h=a(d);n.set(h,t[c]=bt(h,d))}let f=s[2][s[1]].areas||[];const u=c=>"a"+c[40];for(let c=0;c<f.length;c+=1){let d=mt(s,f,c),h=u(d);r.set(h,i[c]=yt(h,d))}return{c(){e=T("div");for(let c=0;c<t.length;c+=1)t[c].c();o=A();for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=C(c,"DIV",{class:!0});var d=M(e);for(let h=0;h<t.length;h+=1)t[h].l(d);o=L(d);for(let h=0;h<i.length;h+=1)i[h].l(d);d.forEach(_),this.h()},h(){p(e,"class","node-outputs svelte-cnz2jn")},m(c,d){U(c,e,d);for(let h=0;h<t.length;h+=1)t[h].m(e,null);v(e,o);for(let h=0;h<i.length;h+=1)i[h].m(e,null)},p(c,d){d[0]&2379782&&(l=c[2][c[1]][c[12]]||[],t=je(t,d,a,1,c,l,n,e,Je,bt,o,gt)),d[0]&4521990&&(f=c[2][c[1]].areas||[],i=je(i,d,u,1,c,f,r,e,Je,yt,null,mt))},d(c){c&&_(e);for(let d=0;d<t.length;d+=1)t[d].d();for(let d=0;d<i.length;d+=1)i[d].d()}}}function Ln(s){let e,t,n,o,i,r,l,a,f,u=(s[6][s[11]].length<210?s[6][s[11]]:s[6][s[11]].slice(0,210)+"...")+"",c,d,h,S,w,E,y,m,b,g,k,I,W,q,Z,ee,R,z,G,V,J,O,Y,ne=s[7],K,se,j,X=s[6][s[13]]!==void 0&&s[6][s[13]]!==null&&vt(s),x=s[6][s[13]]!==void 0&&s[6][s[13]]!==null&&_t(s),ie=wt(s);return{c(){e=T("div"),t=A(),n=T("h1"),o=F("Escena: "),i=F(s[1]),r=A(),X&&X.c(),l=A(),a=T("div"),f=T("p"),c=F(u),d=A(),h=T("div"),S=T("div"),w=T("span"),E=F("escena"),y=A(),m=T("div"),b=T("button"),g=F("editar"),k=A(),I=T("button"),W=F("x"),q=A(),Z=T("div"),ee=T("span"),R=F("btn"),z=A(),G=T("div"),V=T("button"),J=F("+"),O=A(),x&&x.c(),Y=A(),ie.c(),K=_e(),this.h()},l(N){e=C(N,"DIV",{key:!0,class:!0}),M(e).forEach(_),t=L(N),n=C(N,"H1",{class:!0});var B=M(n);o=H(B,"Escena: "),i=H(B,s[1]),B.forEach(_),r=L(N),X&&X.l(N),l=L(N),a=C(N,"DIV",{class:!0});var D=M(a);f=C(D,"P",{class:!0});var Q=M(f);c=H(Q,u),Q.forEach(_),D.forEach(_),d=L(N),h=C(N,"DIV",{class:!0});var ae=M(h);S=C(ae,"DIV",{});var re=M(S);w=C(re,"SPAN",{class:!0});var Ee=M(w);E=H(Ee,"escena"),Ee.forEach(_),y=L(re),m=C(re,"DIV",{class:!0});var De=M(m);b=C(De,"BUTTON",{class:!0});var Ae=M(b);g=H(Ae,"editar"),Ae.forEach(_),k=L(De),I=C(De,"BUTTON",{class:!0});var me=M(I);W=H(me,"x"),me.forEach(_),De.forEach(_),re.forEach(_),q=L(ae),Z=C(ae,"DIV",{});var ce=M(Z);ee=C(ce,"SPAN",{class:!0});var ge=M(ee);R=H(ge,"btn"),ge.forEach(_),z=L(ce),G=C(ce,"DIV",{class:!0});var Le=M(G);V=C(Le,"BUTTON",{class:!0});var Ve=M(V);J=H(Ve,"+"),Ve.forEach(_),Le.forEach(_),ce.forEach(_),O=L(ae),x&&x.l(ae),ae.forEach(_),Y=L(N),ie.l(N),K=_e(),this.h()},h(){p(e,"key",s[1]),p(e,"class","connection input svelte-cnz2jn"),p(n,"class","svelte-cnz2jn"),p(f,"class","text-p svelte-cnz2jn"),p(a,"class","p-container svelte-cnz2jn"),p(w,"class","btns-name svelte-cnz2jn"),p(b,"class","svelte-cnz2jn"),p(I,"class","svelte-cnz2jn"),p(m,"class","node-btns-div svelte-cnz2jn"),p(ee,"class","btns-name svelte-cnz2jn"),p(V,"class","svelte-cnz2jn"),p(G,"class","node-btns-div svelte-cnz2jn"),p(h,"class","node-btns svelte-cnz2jn")},m(N,B){U(N,e,B),U(N,t,B),U(N,n,B),v(n,o),v(n,i),U(N,r,B),X&&X.m(N,B),U(N,l,B),U(N,a,B),v(a,f),v(f,c),U(N,d,B),U(N,h,B),v(h,S),v(S,w),v(w,E),v(S,y),v(S,m),v(m,b),v(b,g),v(m,k),v(m,I),v(I,W),v(h,q),v(h,Z),v(Z,ee),v(ee,R),v(Z,z),v(Z,G),v(G,V),v(V,J),v(h,O),x&&x.m(h,null),U(N,Y,B),ie.m(N,B),U(N,K,B),se||(j=[P(e,"mousedown",we(s[28])),P(e,"click",s[19]),P(b,"click",s[8]),P(I,"click",s[20]),P(V,"click",s[9])],se=!0)},p(N,B){B[0]&2&&p(e,"key",N[1]),B[0]&2&&Fe(i,N[1]),N[6][N[13]]!==void 0&&N[6][N[13]]!==null?X?X.p(N,B):(X=vt(N),X.c(),X.m(l.parentNode,l)):X&&(X.d(1),X=null),B[0]&64&&u!==(u=(N[6][N[11]].length<210?N[6][N[11]]:N[6][N[11]].slice(0,210)+"...")+"")&&Fe(c,u),N[6][N[13]]!==void 0&&N[6][N[13]]!==null?x?x.p(N,B):(x=_t(N),x.c(),x.m(h,null)):x&&(x.d(1),x=null),B[0]&128&&Ne(ne,ne=N[7])?(ie.d(1),ie=wt(N),ie.c(),ie.m(K.parentNode,K)):ie.p(N,B)},d(N){N&&_(e),N&&_(t),N&&_(n),N&&_(r),X&&X.d(N),N&&_(l),N&&_(a),N&&_(d),N&&_(h),x&&x.d(),N&&_(Y),N&&_(K),ie.d(N),se=!1,ze(j)}}}function kt(s){let e,t,n;function o(r){s[30](r)}let i={key:s[1],pos:s[6].display};return s[3]!==void 0&&(i.showEditor=s[3]),e=new An({props:i}),ue.push(()=>ke(e,"showEditor",o)),{c(){fe(e.$$.fragment)},l(r){de(e.$$.fragment,r)},m(r,l){he(e,r,l),n=!0},p(r,l){const a={};l[0]&2&&(a.key=r[1]),l[0]&64&&(a.pos=r[6].display),!t&&l[0]&8&&(t=!0,a.showEditor=r[3],Se(()=>t=!1)),e.$set(a)},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){te(e.$$.fragment,r),n=!1},d(r){pe(e,r)}}}function St(s){let e,t,n;function o(r){s[31](r)}let i={key:s[1],pos:s[6].display};return s[4]!==void 0&&(i.showNewOption=s[4]),e=new kn({props:i}),ue.push(()=>ke(e,"showNewOption",o)),{c(){fe(e.$$.fragment)},l(r){de(e.$$.fragment,r)},m(r,l){he(e,r,l),n=!0},p(r,l){const a={};l[0]&2&&(a.key=r[1]),l[0]&64&&(a.pos=r[6].display),!t&&l[0]&16&&(t=!0,a.showNewOption=r[4],Se(()=>t=!1)),e.$set(a)},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){te(e.$$.fragment,r),n=!1},d(r){pe(e,r)}}}function Et(s){let e,t,n;function o(r){s[32](r)}let i={key:s[1],pos:s[6].display};return s[5]!==void 0&&(i.showNewArea=s[5]),e=new In({props:i}),ue.push(()=>ke(e,"showNewArea",o)),{c(){fe(e.$$.fragment)},l(r){de(e.$$.fragment,r)},m(r,l){he(e,r,l),n=!0},p(r,l){const a={};l[0]&2&&(a.key=r[1]),l[0]&64&&(a.pos=r[6].display),!t&&l[0]&32&&(t=!0,a.showNewArea=r[5],Se(()=>t=!1)),e.$set(a)},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){te(e.$$.fragment,r),n=!1},d(r){pe(e,r)}}}function Un(s){let e,t,n,o,i,r,l;function a(h){s[29](h)}let f={scene:s[6],key:s[1],$$slots:{default:[Ln]},$$scope:{ctx:s}};s[0]!==void 0&&(f.movingNode=s[0]),e=new pn({props:f}),ue.push(()=>ke(e,"movingNode",a));let u=s[3]&&kt(s),c=s[4]&&St(s),d=s[5]&&Et(s);return{c(){fe(e.$$.fragment),n=A(),u&&u.c(),o=A(),c&&c.c(),i=A(),d&&d.c(),r=_e()},l(h){de(e.$$.fragment,h),n=L(h),u&&u.l(h),o=L(h),c&&c.l(h),i=L(h),d&&d.l(h),r=_e()},m(h,S){he(e,h,S),U(h,n,S),u&&u.m(h,S),U(h,o,S),c&&c.m(h,S),U(h,i,S),d&&d.m(h,S),U(h,r,S),l=!0},p(h,S){const w={};S[0]&64&&(w.scene=h[6]),S[0]&2&&(w.key=h[1]),S[0]&198|S[1]&4096&&(w.$$scope={dirty:S,ctx:h}),!t&&S[0]&1&&(t=!0,w.movingNode=h[0],Se(()=>t=!1)),e.$set(w),h[3]?u?(u.p(h,S),S[0]&8&&$(u,1)):(u=kt(h),u.c(),$(u,1),u.m(o.parentNode,o)):u&&(We(),te(u,1,1,()=>{u=null}),Ke()),h[4]?c?(c.p(h,S),S[0]&16&&$(c,1)):(c=St(h),c.c(),$(c,1),c.m(i.parentNode,i)):c&&(We(),te(c,1,1,()=>{c=null}),Ke()),h[5]?d?(d.p(h,S),S[0]&32&&$(d,1)):(d=Et(h),d.c(),$(d,1),d.m(r.parentNode,r)):d&&(We(),te(d,1,1,()=>{d=null}),Ke())},i(h){l||($(e.$$.fragment,h),$(u),$(c),$(d),l=!0)},o(h){te(e.$$.fragment,h),te(u),te(c),te(d),l=!1},d(h){pe(e,h),h&&_(n),u&&u.d(h),h&&_(o),c&&c.d(h),h&&_(i),d&&d.d(h),h&&_(r)}}}function Bn(s,e,t){let n,o,i,r,l,a,f;oe(s,qe,N=>t(7,n=N)),oe(s,le,N=>t(2,o=N)),oe(s,it,N=>t(33,i=N)),oe(s,st,N=>t(34,r=N)),oe(s,Ye,N=>t(35,l=N)),oe(s,Yt,N=>t(36,a=N)),oe(s,xt,N=>t(37,f=N));let{movingNode:u=!1}=e,{key:c}=e,d=!1,h=!1,S=!1;function w(){t(3,d=!0)}function E(){t(4,h=!0)}function y(){t(5,S=!0)}let m=o[c];const b=f(m),g=r(m),k=a(m);m.display===void 0&&(m.display={x:0,y:0});function I(){W(this)}function W(N){const B=+N.getAttribute("i");N.style.width=N.value.length*6.1+"px",t(6,m[g][B].btn=N.value,m),le.set(o)}function q(){Z(this)}function Z(N){const B=+N.getAttribute("i");N.style.width=N.value.length*6.1+"px",t(6,m.areas[B].name=N.value,m),le.set(o)}function ee(N){const B=N.target,D=+B.getAttribute("i"),Q=B.getAttribute("type");if(l!==void 0&&l.key===c&&l.i===D&&l.type===Q){ve(Ye,l=void 0,l);const ae=Q==="ops"?g:"areas",re=i(m[ae][D]);t(6,m[ae][D][re]=void 0,m);return}ve(Ye,l={key:c,i:D,type:Q},l)}function R(){if(l===void 0)return;const N=o[l.key],B=l.type==="ops"?r(N):"areas",D=i(N[B][l.i]);N[B][l.i][D]=c,ve(Ye,l=void 0,l)}function z(){for(let N of Object.keys(o)){const B=r(o[N]);if(o[N][B]!==void 0){for(let D of o[N][B]){const Q=i(D);D[Q]===c&&(D[Q]=void 0)}if(o[N].areas!==void 0)for(let D of o[N].areas){const Q=i(D);D[Q]===c&&(D[Q]=void 0)}}}delete o[c],le.set(o)}function G(N){const D=+N.target.getAttribute("i");o[c][g].splice(D,1),le.set(o),ve(qe,n=!n,n)}function V(N){const D=+N.target.getAttribute("i");o[c].areas.splice(D,1),le.set(o),ve(qe,n=!n,n)}function J(){delete o[c][k],delete o[c].areas,le.set(o),ve(qe,n=!n,n)}function O(N){ye.call(this,s,N)}function Y(N){ye.call(this,s,N)}function ne(N){ye.call(this,s,N)}function K(N){ye.call(this,s,N)}function se(N){ye.call(this,s,N)}function j(N){u=N,t(0,u)}function X(N){d=N,t(3,d)}function x(N){h=N,t(4,h)}function ie(N){S=N,t(5,S)}return s.$$set=N=>{"movingNode"in N&&t(0,u=N.movingNode),"key"in N&&t(1,c=N.key)},s.$$.update=()=>{s.$$.dirty[0]&6&&t(6,m=o[c])},[u,c,o,d,h,S,m,n,w,E,y,b,g,k,I,W,q,Z,ee,R,z,G,V,J,O,Y,ne,K,se,j,X,x,ie]}class jn extends Te{constructor(e){super(),Ce(this,e,Bn,Un,Ne,{movingNode:0,key:1},null,[-1,-1])}}function Nt(s,e,t){const n=s.slice();return n[13]=e[t],n[15]=t,n}function It(s,e,t){const n=s.slice();return n[13]=e[t],n[15]=t,n}function Tt(s){let e,t=[],n=new Map,o,i=[],r=new Map,l=s[0][s[2]]||[];const a=c=>"op"+c[15];for(let c=0;c<l.length;c+=1){let d=It(s,l,c),h=a(d);n.set(h,t[c]=Ct(h,d))}let f=s[0].areas||[];const u=c=>"a"+c[15];for(let c=0;c<f.length;c+=1){let d=Nt(s,f,c),h=u(d);r.set(h,i[c]=Mt(h,d))}return{c(){e=Re("g");for(let c=0;c<t.length;c+=1)t[c].c();o=_e();for(let c=0;c<i.length;c+=1)i[c].c()},l(c){e=Pe(c,"g",{});var d=M(e);for(let h=0;h<t.length;h+=1)t[h].l(d);o=_e();for(let h=0;h<i.length;h+=1)i[h].l(d);d.forEach(_)},m(c,d){U(c,e,d);for(let h=0;h<t.length;h+=1)t[h].m(e,null);v(e,o);for(let h=0;h<i.length;h+=1)i[h].m(e,null)},p(c,d){d&13&&(l=c[0][c[2]]||[],t=je(t,d,a,1,c,l,n,e,Je,Ct,o,It)),d&9&&(f=c[0].areas||[],i=je(i,d,u,1,c,f,r,e,Je,Mt,null,Nt))},d(c){c&&_(e);for(let d=0;d<t.length;d+=1)t[d].d();for(let d=0;d<i.length;d+=1)i[d].d()}}}function Ct(s,e){let t,n;return{key:s,first:null,c(){t=Re("path"),this.h()},l(o){t=Pe(o,"path",{class:!0,d:!0}),M(t).forEach(_),this.h()},h(){p(t,"class","connection op-connection svelte-1h0rpzd"),p(t,"d",n=e[3]("ops",e[15])),this.first=t},m(o,i){U(o,t,i)},p(o,i){e=o,i&1&&n!==(n=e[3]("ops",e[15]))&&p(t,"d",n)},d(o){o&&_(t)}}}function Mt(s,e){let t,n;return{key:s,first:null,c(){t=Re("path"),this.h()},l(o){t=Pe(o,"path",{class:!0,d:!0}),M(t).forEach(_),this.h()},h(){p(t,"class","connection a-connection svelte-1h0rpzd"),p(t,"d",n=e[3]("areas",e[15])),this.first=t},m(o,i){U(o,t,i)},p(o,i){e=o,i&1&&n!==(n=e[3]("areas",e[15]))&&p(t,"d",n)},d(o){o&&_(t)}}}function Rn(s){let e,t=s[1]&&Tt(s);return{c(){t&&t.c(),e=_e()},l(n){t&&t.l(n),e=_e()},m(n,o){t&&t.m(n,o),U(n,e,o)},p(n,[o]){n[1]?t?t.p(n,o):(t=Tt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Oe,o:Oe,d(n){t&&t.d(n),n&&_(e)}}}function Pn(s,e,t){let n,o,i,r;oe(s,le,E=>t(7,n=E)),oe(s,Ye,E=>t(8,o=E)),oe(s,it,E=>t(9,i=E)),oe(s,st,E=>t(10,r=E));let{key:l}=e,{pageMouse:a}=e,{movingNode:f}=e,u=n[l],c=r(u),d=!1;Xt(()=>{t(1,d=!0)});function h(E,y,m){const b=document.querySelector(`[type=${y}][i="${m}"][key=${l}]`);if(!b)return n[l].display[E];const g=E==="x"?b.offsetLeft:b.offsetTop,k=E==="x"?b.offsetWidth/2+2:b.offsetHeight;return n[l].display[E]+g+k}function S(E,y,m){const b=y==="ops"?c:"areas",g=u[b][m],k=i(g),I=u[b][m][k];if(o!==void 0&&o.key===l&&o.i===m&&o.type===y)return a[E];if(I===void 0)return h(E,y,m);{const W=document.querySelector(`.input[key=${I}]`);return n[I].display[E]+(E==="x"?W.offsetLeft:W.offsetTop)+7}}function w(E,y){const m={x:h("x",E,y),y:h("y",E,y)},b={x:S("x",E,y),y:S("y",E,y)},g=(b.y-m.y)/2,k=(m.y-b.y)/2;return`M ${m.x}, ${m.y} C ${m.x}, ${m.y+g} ${b.x}, ${b.y+k} ${b.x}, ${b.y}`}return s.$$set=E=>{"key"in E&&t(4,l=E.key),"pageMouse"in E&&t(5,a=E.pageMouse),"movingNode"in E&&t(6,f=E.movingNode)},s.$$.update=()=>{s.$$.dirty&225&&(a||n||f)&&(t(0,u),t(5,a),t(7,n),t(6,f))},[u,d,c,w,l,a,f,n]}class Vn extends Te{constructor(e){super(),Ce(this,e,Pn,Rn,Ne,{key:4,pageMouse:5,movingNode:6})}}function qn(s){let e,t,n,o,i,r,l,a,f,u,c,d,h,S,w;function E(m){s[8](m)}let y={};return s[0]!==void 0&&(y.toggle=s[0]),e=new xe({props:y}),ue.push(()=>ke(e,"toggle",E)),{c(){fe(e.$$.fragment),n=A(),o=T("div"),i=T("label"),r=F("Escena:"),l=A(),a=T("input"),f=A(),u=T("div"),c=T("button"),d=F("Aceptar"),this.h()},l(m){de(e.$$.fragment,m),n=L(m),o=C(m,"DIV",{});var b=M(o);i=C(b,"LABEL",{for:!0});var g=M(i);r=H(g,"Escena:"),g.forEach(_),l=L(b),a=C(b,"INPUT",{id:!0,type:!0}),b.forEach(_),f=L(m),u=C(m,"DIV",{class:!0});var k=M(u);c=C(k,"BUTTON",{class:!0});var I=M(c);d=H(I,"Aceptar"),I.forEach(_),k.forEach(_),this.h()},h(){p(i,"for","inp"),p(a,"id","inp"),p(a,"type","text"),p(c,"class","gui-button"),p(u,"class","bar svelte-1bhrmvp")},m(m,b){he(e,m,b),U(m,n,b),U(m,o,b),v(o,i),v(i,r),v(o,l),v(o,a),Ie(a,s[2]),U(m,f,b),U(m,u,b),v(u,c),v(c,d),h=!0,S||(w=[P(a,"input",s[9]),P(a,"mousedown",we(s[7])),P(c,"click",s[4])],S=!0)},p(m,b){const g={};!t&&b&1&&(t=!0,g.toggle=m[0],Se(()=>t=!1)),e.$set(g),b&4&&a.value!==m[2]&&Ie(a,m[2])},i(m){h||($(e.$$.fragment,m),h=!0)},o(m){te(e.$$.fragment,m),h=!1},d(m){pe(e,m),m&&_(n),m&&_(o),m&&_(f),m&&_(u),S=!1,ze(w)}}}function Gn(s){let e,t,n,o,i;function r(a){s[10](a)}let l={pos:s[3],$$slots:{default:[qn]},$$scope:{ctx:s}};return s[1]!==void 0&&(l.displace=s[1]),e=new Qe({props:l}),ue.push(()=>ke(e,"displace",r)),{c(){fe(e.$$.fragment)},l(a){de(e.$$.fragment,a)},m(a,f){he(e,a,f),n=!0,o||(i=P(window,"keydown",s[5]),o=!0)},p(a,[f]){const u={};f&8197&&(u.$$scope={dirty:f,ctx:a}),!t&&f&2&&(t=!0,u.displace=a[1],Se(()=>t=!1)),e.$set(u)},i(a){n||($(e.$$.fragment,a),n=!0)},o(a){te(e.$$.fragment,a),n=!1},d(a){pe(e,a),o=!1,i()}}}function Wn(s){const e=["á","é","í","ó","ú","ü","ñ"],t=["a","e","i","o","u","u","n"],n=s.toLowerCase();let o="";for(let i=0;i<s.length;i++){const r=n.charAt(i),l=s.charAt(i);if(e.includes(r)){let a;for(let f=0;f<e.length;f++)if(e[f]===r){a=f;break}l===l.toUpperCase()?o+=t[a].toUpperCase():o+=t[a]}else o+=l}return o}function Kn(s,e,t){let n,o;oe(s,le,E=>t(12,o=E));let{showNewScene:i}=e,{offset:r}=e,l=o,a={x:r.x*-1+20,y:r.y*-1+20},f;function u(){if(n.length<=0){alert(`Debes dar un nombre a la escena /
You must give a name to the scene`);return}if(/^\d/.test(n)===!0){alert(`El nombre de la escena no puede empezar con un número /
The name of the scene cannot start with a number`);return}let E=n.replace(/\s/gi,"_").replace(/\W/,"").replace(/[;.,:{}()<>$%&!¡?¿"'/\\#@&*+-]/gi,"");if(E=Wn(E),o[E]!==void 0){alert(`Ya existe una escena con ese nombre /
There is already a scene with that name`);return}l[E]={text:"",display:{x:a.x,y:a.y}},ve(le,o[E]=l[E],o),t(0,i=!1)}function c(E){E.key==="Enter"&&u(),E.key==="Escape"&&t(0,i=!1)}function d(E){ye.call(this,s,E)}function h(E){i=E,t(0,i)}function S(){n=this.value,t(2,n)}function w(E){f=E,t(1,f)}return s.$$set=E=>{"showNewScene"in E&&t(0,i=E.showNewScene),"offset"in E&&t(6,r=E.offset)},t(2,n=""),[i,f,n,a,u,c,r,d,h,S,w]}class Fn extends Te{constructor(e){super(),Ce(this,e,Kn,Gn,Ne,{showNewScene:0,offset:6})}}function zt(s,e,t){const n=s.slice();return n[24]=e[t][0],n[25]=e[t][1],n}function Dt(s,e,t){const n=s.slice();return n[28]=e[t],n[30]=t,n}function Ot(s,e,t){const n=s.slice();return n[28]=e[t],n[30]=t,n}function At(s,e,t){const n=s.slice();return n[32]=e[t],n}function Lt(s,e,t){const n=s.slice();return n[32]=e[t],n}function Ut(s,e){let t,n,o,i,r,l,a;function f(c){e[16](c)}let u={key:e[32]};return e[4]!==void 0&&(u.movingNode=e[4]),n=new jn({props:u}),ue.push(()=>ke(n,"movingNode",f)),{key:s,first:null,c(){t=T("div"),fe(n.$$.fragment),this.h()},l(c){t=C(c,"DIV",{class:!0,key:!0});var d=M(t);de(n.$$.fragment,d),d.forEach(_),this.h()},h(){p(t,"class","scene-node-container-div"),p(t,"key",i=e[32]),this.first=t},m(c,d){U(c,t,d),he(n,t,null),r=!0,l||(a=P(t,"mouseenter",Jn),l=!0)},p(c,d){e=c;const h={};d[0]&128&&(h.key=e[32]),!o&&d[0]&16&&(o=!0,h.movingNode=e[4],Se(()=>o=!1)),n.$set(h),(!r||d[0]&128&&i!==(i=e[32]))&&p(t,"key",i)},i(c){r||($(n.$$.fragment,c),r=!0)},o(c){te(n.$$.fragment,c),r=!1},d(c){c&&_(t),pe(n),l=!1,a()}}}function Bt(s,e){let t,n,o;return n=new Vn({props:{key:e[32],pageMouse:e[1],movingNode:e[4]}}),{key:s,first:null,c(){t=_e(),fe(n.$$.fragment),this.h()},l(i){t=_e(),de(n.$$.fragment,i),this.h()},h(){this.first=t},m(i,r){U(i,t,r),he(n,i,r),o=!0},p(i,r){e=i;const l={};r[0]&128&&(l.key=e[32]),r[0]&2&&(l.pageMouse=e[1]),r[0]&16&&(l.movingNode=e[4]),n.$set(l)},i(i){o||($(n.$$.fragment,i),o=!0)},o(i){te(n.$$.fragment,i),o=!1},d(i){i&&_(t),pe(n,i)}}}function jt(s){let e,t,n;function o(r){s[17](r)}let i={offset:s[5]};return s[0]!==void 0&&(i.showNewScene=s[0]),e=new Fn({props:i}),ue.push(()=>ke(e,"showNewScene",o)),{c(){fe(e.$$.fragment)},l(r){de(e.$$.fragment,r)},m(r,l){he(e,r,l),n=!0},p(r,l){const a={};l[0]&32&&(a.offset=r[5]),!t&&l[0]&1&&(t=!0,a.showNewScene=r[0],Se(()=>t=!1)),e.$set(a)},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){te(e.$$.fragment,r),n=!1},d(r){pe(e,r)}}}function Rt(s){let e,t=[],n=new Map,o,i,r,l=s[2];const a=u=>u[24];for(let u=0;u<l.length;u+=1){let c=zt(s,l,u),d=a(c);n.set(d,t[u]=qt(d,c))}let f=s[6]!==void 0&&Gt(s);return{c(){e=Re("svg");for(let u=0;u<t.length;u+=1)t[u].c();o=_e(),f&&f.c(),this.h()},l(u){e=Pe(u,"svg",{width:!0,height:!0});var c=M(e);for(let d=0;d<t.length;d+=1)t[d].l(c);o=_e(),f&&f.l(c),c.forEach(_),this.h()},h(){p(e,"width","100%"),p(e,"height","100%")},m(u,c){U(u,e,c);for(let d=0;d<t.length;d+=1)t[d].m(e,null);v(e,o),f&&f.m(e,null),i||(r=P(e,"click",s[9]),i=!0)},p(u,c){c[0]&8516&&(l=u[2],t=je(t,c,a,1,u,l,n,e,Je,qt,o,zt)),u[6]!==void 0?f?f.p(u,c):(f=Gt(u),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},d(u){u&&_(e);for(let c=0;c<t.length;c+=1)t[c].d();f&&f.d(),i=!1,r()}}}function Pt(s,e){let t,n,o,i,r;return{key:s,first:null,c(){t=Re("line"),this.h()},l(l){t=Pe(l,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0});var a=M(t);a.forEach(_),this.h()},h(){p(t,"x1",n=e[25].display.x/be+Me(e[24],"width")/2),p(t,"y1",o=e[25].display.y/be+Me(e[24],"height")),p(t,"x2",i=e[13](e[25],e[28],"x")),p(t,"y2",r=e[13](e[25],e[28],"y")),p(t,"stroke","var(--scene-stroke)"),this.first=t},m(l,a){U(l,t,a)},p(l,a){e=l,a[0]&4&&n!==(n=e[25].display.x/be+Me(e[24],"width")/2)&&p(t,"x1",n),a[0]&4&&o!==(o=e[25].display.y/be+Me(e[24],"height"))&&p(t,"y1",o),a[0]&260&&i!==(i=e[13](e[25],e[28],"x"))&&p(t,"x2",i),a[0]&260&&r!==(r=e[13](e[25],e[28],"y"))&&p(t,"y2",r)},d(l){l&&_(t)}}}function Vt(s,e){let t,n,o,i,r;return{key:s,first:null,c(){t=Re("line"),this.h()},l(l){t=Pe(l,"line",{x1:!0,y1:!0,x2:!0,y2:!0,stroke:!0});var a=M(t);a.forEach(_),this.h()},h(){p(t,"x1",n=e[25].display.x/be+Me(e[24],"width")/2),p(t,"y1",o=e[25].display.y/be+Me(e[24],"height")),p(t,"x2",i=e[13](e[25],e[28],"x")),p(t,"y2",r=e[13](e[25],e[28],"y")),p(t,"stroke","var(--area-stroke)"),this.first=t},m(l,a){U(l,t,a)},p(l,a){e=l,a[0]&4&&n!==(n=e[25].display.x/be+Me(e[24],"width")/2)&&p(t,"x1",n),a[0]&4&&o!==(o=e[25].display.y/be+Me(e[24],"height"))&&p(t,"y1",o),a[0]&4&&i!==(i=e[13](e[25],e[28],"x"))&&p(t,"x2",i),a[0]&4&&r!==(r=e[13](e[25],e[28],"y"))&&p(t,"y2",r)},d(l){l&&_(t)}}}function qt(s,e){let t,n=[],o=new Map,i,r=[],l=new Map,a,f,u,c,d,h,S,w=e[25][e[8](e[25])]||[];const E=g=>g[30];for(let g=0;g<w.length;g+=1){let k=Ot(e,w,g),I=E(k);o.set(I,n[g]=Pt(I,k))}let y=e[25].areas||[];const m=g=>g[30];for(let g=0;g<y.length;g+=1){let k=Dt(e,y,g),I=m(k);l.set(I,r[g]=Vt(I,k))}function b(){return e[19](e[24])}return{key:s,first:null,c(){t=_e();for(let g=0;g<n.length;g+=1)n[g].c();i=_e();for(let g=0;g<r.length;g+=1)r[g].c();a=Re("rect"),this.h()},l(g){t=_e();for(let I=0;I<n.length;I+=1)n[I].l(g);i=_e();for(let I=0;I<r.length;I+=1)r[I].l(g);a=Pe(g,"rect",{class:!0,x:!0,y:!0,width:!0,height:!0});var k=M(a);k.forEach(_),this.h()},h(){p(a,"class","minimap-rect svelte-j7o2a0"),p(a,"x",f=e[25].display.x/be),p(a,"y",u=e[25].display.y/be),p(a,"width",c=Me(e[24],"width")),p(a,"height",d=Me(e[24],"height")),this.first=t},m(g,k){U(g,t,k);for(let I=0;I<n.length;I+=1)n[I].m(g,k);U(g,i,k);for(let I=0;I<r.length;I+=1)r[I].m(g,k);U(g,a,k),h||(S=[P(a,"mouseleave",e[18]),P(a,"mouseenter",b)],h=!0)},p(g,k){e=g,k[0]&8452&&(w=e[25][e[8](e[25])]||[],n=je(n,k,E,1,e,w,o,i.parentNode,Je,Pt,i,Ot)),k[0]&8196&&(y=e[25].areas||[],r=je(r,k,m,1,e,y,l,a.parentNode,Je,Vt,a,Dt)),k[0]&4&&f!==(f=e[25].display.x/be)&&p(a,"x",f),k[0]&4&&u!==(u=e[25].display.y/be)&&p(a,"y",u),k[0]&4&&c!==(c=Me(e[24],"width"))&&p(a,"width",c),k[0]&4&&d!==(d=Me(e[24],"height"))&&p(a,"height",d)},d(g){g&&_(t);for(let k=0;k<n.length;k+=1)n[k].d(g);g&&_(i);for(let k=0;k<r.length;k+=1)r[k].d(g);g&&_(a),h=!1,ze(S)}}}function Gt(s){let e,t;return{c(){e=Re("text"),t=F(s[6]),this.h()},l(n){e=Pe(n,"text",{x:!0,y:!0,fill:!0,"font-size":!0});var o=M(e);t=H(o,s[6]),o.forEach(_),this.h()},h(){p(e,"x",5),p(e,"y",343),p(e,"fill","#ffffff99"),p(e,"font-size","0.9em")},m(n,o){U(n,e,o),v(e,t)},p(n,o){o[0]&64&&Fe(t,n[6])},d(n){n&&_(e)}}}function Hn(s){let e,t=[],n=new Map,o,i,r=[],l=new Map,a,f,u,c,d,h,S=s[7];const w=g=>g[32];for(let g=0;g<S.length;g+=1){let k=Lt(s,S,g),I=w(k);n.set(I,t[g]=Ut(I,k))}let E=s[7];const y=g=>g[32];for(let g=0;g<E.length;g+=1){let k=At(s,E,g),I=y(k);l.set(I,r[g]=Bt(I,k))}let m=s[0]&&jt(s),b=s[3]&&Rt(s);return{c(){e=T("div");for(let g=0;g<t.length;g+=1)t[g].c();o=A(),i=Re("svg");for(let g=0;g<r.length;g+=1)r[g].c();a=A(),m&&m.c(),f=A(),u=T("div"),b&&b.c(),this.h()},l(g){e=C(g,"DIV",{class:!0});var k=M(e);for(let q=0;q<t.length;q+=1)t[q].l(k);o=L(k),i=Pe(k,"svg",{class:!0});var I=M(i);for(let q=0;q<r.length;q+=1)r[q].l(I);I.forEach(_),a=L(k),m&&m.l(k),k.forEach(_),f=L(g),u=C(g,"DIV",{class:!0});var W=M(u);b&&b.l(W),W.forEach(_),this.h()},h(){p(i,"class","connections-container svelte-j7o2a0"),p(e,"class","node-page svelte-j7o2a0"),p(u,"class","minimap-container svelte-j7o2a0")},m(g,k){U(g,e,k);for(let I=0;I<t.length;I+=1)t[I].m(e,null);v(e,o),v(e,i);for(let I=0;I<r.length;I+=1)r[I].m(i,null);v(e,a),m&&m.m(e,null),U(g,f,k),U(g,u,k),b&&b.m(u,null),c=!0,d||(h=[P(e,"mousedown",s[10]),P(e,"mouseup",s[11]),P(e,"mousemove",s[12]),P(e,"mouseleave",s[11]),P(u,"mousedown",we(s[15]))],d=!0)},p(g,k){k[0]&144&&(S=g[7],We(),t=je(t,k,w,1,g,S,n,e,dt,Ut,o,Lt),Ke()),k[0]&146&&(E=g[7],We(),r=je(r,k,y,1,g,E,l,i,dt,Bt,null,At),Ke()),g[0]?m?(m.p(g,k),k[0]&1&&$(m,1)):(m=jt(g),m.c(),$(m,1),m.m(e,null)):m&&(We(),te(m,1,1,()=>{m=null}),Ke()),g[3]?b?b.p(g,k):(b=Rt(g),b.c(),b.m(u,null)):b&&(b.d(1),b=null)},i(g){if(!c){for(let k=0;k<S.length;k+=1)$(t[k]);for(let k=0;k<E.length;k+=1)$(r[k]);$(m),c=!0}},o(g){for(let k=0;k<t.length;k+=1)te(t[k]);for(let k=0;k<r.length;k+=1)te(r[k]);te(m),c=!1},d(g){g&&_(e);for(let k=0;k<t.length;k+=1)t[k].d();for(let k=0;k<r.length;k+=1)r[k].d();m&&m.d(),g&&_(f),g&&_(u),b&&b.d(),d=!1,ze(h)}}}let be=20;function Jn(s){[...document.getElementsByClassName("scene-node-container")].forEach(e=>e.style.zIndex="0"),s.target.firstChild.style.zIndex="1"}function Me(s,e){const t=document.querySelector(`.scene-node-container[key=${s}]`),n=getComputedStyle(t);return Math.floor(+n[e].replace("px","")/be)}function Xn(s,e,t){let n,o,i,r,l;oe(s,le,R=>t(14,i=R)),oe(s,it,R=>t(23,r=R)),oe(s,st,R=>t(8,l=R));let a=!1;Xt(()=>{t(3,a=!0)});let{showNewScene:f}=e,u,c={},d,h,S=!1;const w={x:0,y:0};let E;function y(R){const z=document.querySelector(".node-page"),G=getComputedStyle(z),V=+G.width.replace("px",""),J=+G.height.replace("px",""),O=document.querySelector(".page-container"),Y=getComputedStyle(O),ne=+Y.borderWidth.replace("px","")*2,K=+Y.width.replace("px","")-ne,se=+Y.height.replace("px","")-ne;t(5,w.x=-R.offsetX*be+K/2,w),t(5,w.y=-R.offsetY*be+se/2,w),t(5,w.x=w.x>0?0:-w.x>V-K?-V+K:w.x,w),t(5,w.y=w.y>0?0:-w.y>J-se?-J+se:w.y,w),z.style.left=`${w.x}px`,z.style.top=`${w.y}px`}function m(){S=!0,this.style.cursor="grabbing"}function b(){S=!1,this.style.cursor="grab"}function g(R){if(S&&!u){d===void 0&&(d=+getComputedStyle(this).width.replace("px","")),h===void 0&&(h=+getComputedStyle(this).height.replace("px",""));const G=+getComputedStyle(this.offsetParent).borderWidth.replace("px","")*2,V=+getComputedStyle(this.offsetParent).width.replace("px","")-G,J=+getComputedStyle(this.offsetParent).height.replace("px","")-G;t(5,w.x+=R.movementX,w),t(5,w.y+=R.movementY,w),t(5,w.x=w.x>0?0:V-w.x>d?V-d:w.x,w),t(5,w.y=w.y>0?0:J-w.y>h?J-h:w.y,w),this.style.left=`${w.x}px`,this.style.top=`${w.y}px`}t(1,c={x:R.offsetX,y:R.offsetY});let z=R.target;for(;z!==this;)t(1,c.x+=z.offsetLeft,c),t(1,c.y+=z.offsetTop,c),z=z.offsetParent}function k(R,z,G){const V=z[r(z)],J=i[V];return J===void 0?R.display[G]/be:J.display[G]/be+(G==="x"?Me(V,"width")/2:0)}function I(R){ye.call(this,s,R)}function W(R){u=R,t(4,u)}function q(R){f=R,t(0,f)}const Z=()=>{t(6,E=void 0)},ee=R=>{t(6,E=R)};return s.$$set=R=>{"showNewScene"in R&&t(0,f=R.showNewScene)},s.$$.update=()=>{s.$$.dirty[0]&16384&&t(7,n=Object.keys(i)),s.$$.dirty[0]&16384&&t(2,o=Object.entries(i)),s.$$.dirty[0]&6&&c&&(t(2,o),t(14,i),t(1,c))},[f,c,o,a,u,w,E,n,l,y,m,b,g,k,i,I,W,q,Z,ee]}let Yn=class extends Te{constructor(e){super(),Ce(this,e,Xn,Hn,Ne,{showNewScene:0},null,[-1,-1])}};function Wt(s){let e,t;return e=new Qe({props:{pos:s[2],$$slots:{default:[Zn]},$$scope:{ctx:s}}}),{c(){fe(e.$$.fragment)},l(n){de(e.$$.fragment,n)},m(n,o){he(e,n,o),t=!0},p(n,o){const i={};o&2050&&(i.$$scope={dirty:o,ctx:n}),e.$set(i)},i(n){t||($(e.$$.fragment,n),t=!0)},o(n){te(e.$$.fragment,n),t=!1},d(n){pe(e,n)}}}function Zn(s){let e,t,n,o,i,r,l;function a(u){s[7](u)}let f={};return s[1]!==void 0&&(f.toggle=s[1]),e=new xe({props:f}),ue.push(()=>ke(e,"toggle",a)),{c(){fe(e.$$.fragment),n=A(),o=T("div"),this.h()},l(u){de(e.$$.fragment,u),n=L(u),o=C(u,"DIV",{class:!0,id:!0}),M(o).forEach(_),this.h()},h(){p(o,"class","test-story-container svelte-1sigivs"),p(o,"id","test-story-container")},m(u,c){he(e,u,c),U(u,n,c),U(u,o,c),i=!0,r||(l=He(s[3].call(null,o)),r=!0)},p(u,c){const d={};!t&&c&2&&(t=!0,d.toggle=u[1],Se(()=>t=!1)),e.$set(d)},i(u){i||($(e.$$.fragment,u),i=!0)},o(u){te(e.$$.fragment,u),i=!1},d(u){pe(e,u),u&&_(n),u&&_(o),r=!1,l()}}}function Qn(s){let e,t,n,o,i,r,l,a,f,u,c;function d(m){s[4](m)}function h(m){s[5](m)}let S={};s[0]!==void 0&&(S.showNewScene=s[0]),s[1]!==void 0&&(S.showTest=s[1]),t=new fn({props:S}),ue.push(()=>ke(t,"showNewScene",d)),ue.push(()=>ke(t,"showTest",h));function w(m){s[6](m)}let E={};s[0]!==void 0&&(E.showNewScene=s[0]),a=new Yn({props:E}),ue.push(()=>ke(a,"showNewScene",w));let y=s[1]&&Wt(s);return{c(){e=T("div"),fe(t.$$.fragment),i=A(),r=T("div"),l=T("div"),fe(a.$$.fragment),u=A(),y&&y.c(),this.h()},l(m){e=C(m,"DIV",{class:!0});var b=M(e);de(t.$$.fragment,b),i=L(b),r=C(b,"DIV",{class:!0});var g=M(r);l=C(g,"DIV",{class:!0});var k=M(l);de(a.$$.fragment,k),k.forEach(_),g.forEach(_),u=L(b),y&&y.l(b),b.forEach(_),this.h()},h(){p(l,"class","page-container svelte-1sigivs"),p(r,"class","static-page-container svelte-1sigivs"),p(e,"class","main-window-container svelte-1sigivs")},m(m,b){U(m,e,b),he(t,e,null),v(e,i),v(e,r),v(r,l),he(a,l,null),v(e,u),y&&y.m(e,null),c=!0},p(m,[b]){const g={};!n&&b&1&&(n=!0,g.showNewScene=m[0],Se(()=>n=!1)),!o&&b&2&&(o=!0,g.showTest=m[1],Se(()=>o=!1)),t.$set(g);const k={};!f&&b&1&&(f=!0,k.showNewScene=m[0],Se(()=>f=!1)),a.$set(k),m[1]?y?(y.p(m,b),b&2&&$(y,1)):(y=Wt(m),y.c(),$(y,1),y.m(e,null)):y&&(We(),te(y,1,1,()=>{y=null}),Ke())},i(m){c||($(t.$$.fragment,m),$(a.$$.fragment,m),$(y),c=!0)},o(m){te(t.$$.fragment,m),te(a.$$.fragment,m),te(y),c=!1},d(m){m&&_(e),pe(t),pe(a),y&&y.d()}}}function xn(s,e,t){let n,o,i;oe(s,le,S=>t(8,n=S)),oe(s,ot,S=>t(9,o=S)),oe(s,Qt,S=>t(10,i=S));let r=!1,l=!1,a={x:40,y:40};function f(){const S=document.getElementById("storygeneraldiv"),w=Object.entries(n).sort((b,g)=>b[1].display.y-g[1].display.y);S&&S.remove();const E=new i("es",o);if(w.length===0){alert("No hay escenas / There are no scenes");return}E.setScenes(JSON.parse(JSON.stringify(n))).startAdventure(w[0][0]);const y=document.getElementById("test-story-container"),m=document.getElementById("storygeneraldiv");y.appendChild(m)}function u(S){r=S,t(0,r)}function c(S){l=S,t(1,l)}function d(S){r=S,t(0,r)}function h(S){l=S,t(1,l)}return[r,l,a,f,u,c,d,h]}class $n extends Te{constructor(e){super(),Ce(this,e,xn,Qn,Ne,{})}}function es(s){let e,t,n,o,i,r,l,a,f,u,c,d,h,S,w;return c=new $n({}),{c(){e=T("section"),t=T("div"),n=T("h1"),o=F("Aventura interactiva"),i=A(),r=T("span"),l=F("Un editor de historias interactivas para la librería "),a=T("a"),f=F("Aventura.js"),u=A(),fe(c.$$.fragment),d=A(),h=T("footer"),S=F("Sergio Rodríguez Gómez — 2023 — v1.0.0"),this.h()},l(E){e=C(E,"SECTION",{class:!0});var y=M(e);t=C(y,"DIV",{class:!0});var m=M(t);n=C(m,"H1",{class:!0});var b=M(n);o=H(b,"Aventura interactiva"),b.forEach(_),i=L(m),r=C(m,"SPAN",{class:!0});var g=M(r);l=H(g,"Un editor de historias interactivas para la librería "),a=C(g,"A",{href:!0,target:!0,rel:!0,class:!0});var k=M(a);f=H(k,"Aventura.js"),k.forEach(_),g.forEach(_),m.forEach(_),u=L(y),de(c.$$.fragment,y),d=L(y),h=C(y,"FOOTER",{class:!0});var I=M(h);S=H(I,"Sergio Rodríguez Gómez — 2023 — v1.0.0"),I.forEach(_),y.forEach(_),this.h()},h(){p(n,"class","svelte-18pgm1v"),p(a,"href","https://github.com/srsergiorodriguez/aventura/blob/master/README_es.md"),p(a,"target","_blank"),p(a,"rel","noreferrer"),p(a,"class","svelte-18pgm1v"),p(r,"class","svelte-18pgm1v"),p(t,"class","main-title svelte-18pgm1v"),p(h,"class","no-select svelte-18pgm1v"),p(e,"class","general no-select")},m(E,y){U(E,e,y),v(e,t),v(t,n),v(n,o),v(t,i),v(t,r),v(r,l),v(r,a),v(a,f),v(e,u),he(c,e,null),v(e,d),v(e,h),v(h,S),w=!0},p:Oe,i(E){w||($(c.$$.fragment,E),w=!0)},o(E){te(c.$$.fragment,E),w=!1},d(E){E&&_(e),pe(c)}}}class os extends Te{constructor(e){super(),Ce(this,e,null,es,Ne,{})}}export{os as default};
